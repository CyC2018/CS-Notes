[ğŸ‰ é¢è¯•è¿›é˜¶ä¸“æ å·²ä¸Šçº¿](https://xiaozhuanlan.com/CyC2018)
<!-- GFM-TOC -->
* [ä¸€ã€å‰è¨€](#ä¸€å‰è¨€)
* [äºŒã€ç®—æ³•åˆ†æ](#äºŒç®—æ³•åˆ†æ)
    * [æ•°å­¦æ¨¡å‹](#æ•°å­¦æ¨¡å‹)
    * [æ³¨æ„äº‹é¡¹](#æ³¨æ„äº‹é¡¹)
    * [ThreeSum](#threesum)
    * [å€ç‡å®éªŒ](#å€ç‡å®éªŒ)
* [ä¸‰ã€æ’åº](#ä¸‰æ’åº)
    * [é€‰æ‹©æ’åº](#é€‰æ‹©æ’åº)
    * [å†’æ³¡æ’åº](#å†’æ³¡æ’åº)
    * [æ’å…¥æ’åº](#æ’å…¥æ’åº)
    * [å¸Œå°”æ’åº](#å¸Œå°”æ’åº)
    * [å½’å¹¶æ’åº](#å½’å¹¶æ’åº)
    * [å¿«é€Ÿæ’åº](#å¿«é€Ÿæ’åº)
    * [å †æ’åº](#å †æ’åº)
    * [å°ç»“](#å°ç»“)
* [å››ã€å¹¶æŸ¥é›†](#å››å¹¶æŸ¥é›†)
    * [Quick Find](#quick-find)
    * [Quick Union](#quick-union)
    * [åŠ æƒ Quick Union](#åŠ æƒ-quick-union)
    * [è·¯å¾„å‹ç¼©çš„åŠ æƒ Quick Union](#è·¯å¾„å‹ç¼©çš„åŠ æƒ-quick-union)
    * [æ¯”è¾ƒ](#æ¯”è¾ƒ)
* [äº”ã€æ ˆå’Œé˜Ÿåˆ—](#äº”æ ˆå’Œé˜Ÿåˆ—)
    * [æ ˆ](#æ ˆ)
    * [é˜Ÿåˆ—](#é˜Ÿåˆ—)
* [å…­ã€ç¬¦å·è¡¨](#å…­ç¬¦å·è¡¨)
    * [åˆçº§å®ç°](#åˆçº§å®ç°)
    * [äºŒå‰æŸ¥æ‰¾æ ‘](#äºŒå‰æŸ¥æ‰¾æ ‘)
    * [2-3 æŸ¥æ‰¾æ ‘](#2-3-æŸ¥æ‰¾æ ‘)
    * [çº¢é»‘æ ‘](#çº¢é»‘æ ‘)
    * [æ•£åˆ—è¡¨](#æ•£åˆ—è¡¨)
    * [å°ç»“](#å°ç»“)
* [ä¸ƒã€å…¶å®ƒ](#ä¸ƒå…¶å®ƒ)
    * [æ±‰è¯ºå¡”](#æ±‰è¯ºå¡”)
    * [å“ˆå¤«æ›¼ç¼–ç ](#å“ˆå¤«æ›¼ç¼–ç )
* [å‚è€ƒèµ„æ–™](#å‚è€ƒèµ„æ–™)
<!-- GFM-TOC -->


# ä¸€ã€å‰è¨€

- å®ç°ä»£ç ï¼š[Algorithm](https://github.com/CyC2018/Algorithm)
- ç»˜å›¾æ–‡ä»¶ï¼š[ProcessOn](https://www.processon.com/view/link/5a3e4c1ee4b0ce9ffea8c727)

# äºŒã€ç®—æ³•åˆ†æ

## æ•°å­¦æ¨¡å‹

### 1. è¿‘ä¼¼

N<sup>3</sup>/6-N<sup>2</sup>/2+N/3 \~ N<sup>3</sup>/6ã€‚ä½¿ç”¨ \~f(N) æ¥è¡¨ç¤ºæ‰€æœ‰éšç€ N çš„å¢å¤§é™¤ä»¥ f(N) çš„ç»“æœè¶‹è¿‘äº 1 çš„å‡½æ•°ã€‚

### 2. å¢é•¿æ•°é‡çº§

N<sup>3</sup>/6-N<sup>2</sup>/2+N/3 çš„å¢é•¿æ•°é‡çº§ä¸º O(N<sup>3</sup>)ã€‚å¢é•¿æ•°é‡çº§å°†ç®—æ³•ä¸å®ƒçš„å®ç°éš”ç¦»å¼€æ¥ï¼Œä¸€ä¸ªç®—æ³•çš„å¢é•¿æ•°é‡çº§ä¸º O(N<sup>3</sup>) ä¸å®ƒæ˜¯å¦ç”¨ Java å®ç°ï¼Œæ˜¯å¦è¿è¡Œäºç‰¹å®šè®¡ç®—æœºä¸Šæ— å…³ã€‚

### 3. å†…å¾ªç¯

æ‰§è¡Œæœ€é¢‘ç¹çš„æŒ‡ä»¤å†³å®šäº†ç¨‹åºæ‰§è¡Œçš„æ€»æ—¶é—´ï¼ŒæŠŠè¿™äº›æŒ‡ä»¤ç§°ä¸ºç¨‹åºçš„å†…å¾ªç¯ã€‚

### 4. æˆæœ¬æ¨¡å‹

ä½¿ç”¨æˆæœ¬æ¨¡å‹æ¥è¯„ä¼°ç®—æ³•ï¼Œä¾‹å¦‚æ•°ç»„çš„è®¿é—®æ¬¡æ•°å°±æ˜¯ä¸€ç§æˆæœ¬æ¨¡å‹ã€‚

## æ³¨æ„äº‹é¡¹

### 1. å¤§å¸¸æ•°

åœ¨æ±‚è¿‘ä¼¼æ—¶ï¼Œå¦‚æœä½çº§é¡¹çš„å¸¸æ•°ç³»æ•°å¾ˆå¤§ï¼Œé‚£ä¹ˆè¿‘ä¼¼çš„ç»“æœå°±æ˜¯é”™è¯¯çš„ã€‚

### 2. ç¼“å­˜

è®¡ç®—æœºç³»ç»Ÿä¼šä½¿ç”¨ç¼“å­˜æŠ€æœ¯æ¥ç»„ç»‡å†…å­˜ï¼Œè®¿é—®æ•°ç»„ç›¸é‚»çš„å…ƒç´ ä¼šæ¯”è®¿é—®ä¸ç›¸é‚»çš„å…ƒç´ å¿«å¾ˆå¤šã€‚

### 3. å¯¹æœ€åæƒ…å†µä¸‹çš„æ€§èƒ½çš„ä¿è¯

åœ¨æ ¸ååº”å †ã€å¿ƒè„èµ·æå™¨æˆ–è€…åˆ¹è½¦æ§åˆ¶å™¨ä¸­çš„è½¯ä»¶ï¼Œæœ€åæƒ…å†µä¸‹çš„æ€§èƒ½æ˜¯ååˆ†é‡è¦çš„ã€‚

### 4. éšæœºåŒ–ç®—æ³•

é€šè¿‡æ‰“ä¹±è¾“å…¥ï¼Œå»é™¤ç®—æ³•å¯¹è¾“å…¥çš„ä¾èµ–ã€‚

### 5. å‡æ‘Šåˆ†æ

å°†æ‰€æœ‰æ“ä½œçš„æ€»æˆæœ¬é™¤äºæ“ä½œæ€»æ•°æ¥å°†æˆæœ¬å‡æ‘Šã€‚ä¾‹å¦‚å¯¹ä¸€ä¸ªç©ºæ ˆè¿›è¡Œ N æ¬¡è¿ç»­çš„ push() è°ƒç”¨éœ€è¦è®¿é—®æ•°ç»„çš„æ¬¡æ•°ä¸º N+4+8+16+...+2N=5N-4ï¼ˆN æ˜¯å‘æ•°ç»„å†™å…¥å…ƒç´ çš„æ“ä½œæ¬¡æ•°ï¼Œå…¶ä½™çš„éƒ½æ˜¯è°ƒæ•´æ•°ç»„å¤§å°æ—¶è¿›è¡Œå¤åˆ¶éœ€è¦çš„è®¿é—®æ•°ç»„æ¬¡æ•°ï¼‰ï¼Œå‡æ‘Šåè®¿é—®æ•°ç»„çš„å¹³å‡æ¬¡æ•°ä¸ºå¸¸æ•°ã€‚

## ThreeSum

ThreeSum ç”¨äºç»Ÿè®¡ä¸€ä¸ªæ•°ç»„ä¸­å’Œä¸º 0 çš„ä¸‰å…ƒç»„æ•°é‡ã€‚

```java
public interface ThreeSum {
    int count(int[] nums);
}
```

### 1. ThreeSumSlow

è¯¥ç®—æ³•çš„å†…å¾ªç¯ä¸º `if (nums[i] + nums[j] + nums[k] == 0)` è¯­å¥ï¼Œæ€»å…±æ‰§è¡Œçš„æ¬¡æ•°ä¸º N(N-1)(N-2) = N<sup>3</sup>/6-N<sup>2</sup>/2+N/3ï¼Œå› æ­¤å®ƒçš„è¿‘ä¼¼æ‰§è¡Œæ¬¡æ•°ä¸º \~N<sup>3</sup>/6ï¼Œå¢é•¿æ•°é‡çº§ä¸º O(N<sup>3</sup>)ã€‚

```java
public class ThreeSumSlow implements ThreeSum {
    @Override
    public int count(int[] nums) {
        int N = nums.length;
        int cnt = 0;
        for (int i = 0; i < N; i++) {
            for (int j = i + 1; j < N; j++) {
                for (int k = j + 1; k < N; k++) {
                    if (nums[i] + nums[j] + nums[k] == 0) {
                        cnt++;
                    }
                }
            }
        }
        return cnt;
    }
}
```

### 2. ThreeSumBinarySearch

é€šè¿‡å°†æ•°ç»„å…ˆæ’åºï¼Œå¯¹ä¸¤ä¸ªå…ƒç´ æ±‚å’Œï¼Œå¹¶ç”¨äºŒåˆ†æŸ¥æ‰¾æ–¹æ³•æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨è¯¥å’Œçš„ç›¸åæ•°ï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±è¯´æ˜å­˜åœ¨ä¸‰å…ƒç»„çš„å’Œä¸º 0ã€‚

åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰æ•°ç»„ä¸å«æœ‰ç›¸åŒå…ƒç´ æ‰èƒ½ä½¿ç”¨è¿™ç§è§£æ³•ï¼Œå¦åˆ™äºŒåˆ†æŸ¥æ‰¾çš„ç»“æœä¼šå‡ºé”™ã€‚

è¯¥æ–¹æ³•å¯ä»¥å°† ThreeSum ç®—æ³•å¢é•¿æ•°é‡çº§é™ä½ä¸º O(N<sup>2</sup>logN)ã€‚

```java
public class ThreeSumBinarySearch implements ThreeSum {

    @Override
    public int count(int[] nums) {
        Arrays.sort(nums);
        int N = nums.length;
        int cnt = 0;
        for (int i = 0; i < N; i++) {
            for (int j = i + 1; j < N; j++) {
                int target = -nums[i] - nums[j];
                int index = BinarySearch.search(nums, target);
                // åº”è¯¥æ³¨æ„è¿™é‡Œçš„ä¸‹æ ‡å¿…é¡»å¤§äº jï¼Œå¦åˆ™ä¼šé‡å¤ç»Ÿè®¡ã€‚
                if (index > j) {
                    cnt++;
                }
            }
        }
        return cnt;
    }
}
```

```java
public class BinarySearch {

    public static int search(int[] nums, int target) {
        int l = 0, h = nums.length - 1;
        while (l <= h) {
            int m = l + (h - l) / 2;
            if (target == nums[m]) {
                return m;
            } else if (target > nums[m]) {
                l = m + 1;
            } else {
                h = m - 1;
            }
        }
        return -1;
    }
}
```

### 3. ThreeSumTwoPointer

æ›´æœ‰æ•ˆçš„æ–¹æ³•æ˜¯å…ˆå°†æ•°ç»„æ’åºï¼Œç„¶åä½¿ç”¨åŒæŒ‡é’ˆè¿›è¡ŒæŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(N<sup>2</sup>)ã€‚

```java
public class ThreeSumTwoPointer implements ThreeSum {

    @Override
    public int count(int[] nums) {
        int N = nums.length;
        int cnt = 0;
        Arrays.sort(nums);
        for (int i = 0; i < N - 2; i++) {
            int l = i + 1, h = N - 1, target = -nums[i];
            if (i > 0 && nums[i] == nums[i - 1]) continue;
            while (l < h) {
                int sum = nums[l] + nums[h];
                if (sum == target) {
                    cnt++;
                    while (l < h && nums[l] == nums[l + 1]) l++;
                    while (l < h && nums[h] == nums[h - 1]) h--;
                    l++;
                    h--;
                } else if (sum < target) {
                    l++;
                } else {
                    h--;
                }
            }
        }
        return cnt;
    }
}
```

## å€ç‡å®éªŒ

å¦‚æœ T(N) \~ aN<sup>b</sup>logNï¼Œé‚£ä¹ˆ T(2N)/T(N) \~ 2<sup>b</sup>ã€‚

ä¾‹å¦‚å¯¹äºæš´åŠ›çš„ ThreeSum ç®—æ³•ï¼Œè¿‘ä¼¼æ—¶é—´ä¸º \~N<sup>3</sup>/6ã€‚è¿›è¡Œå¦‚ä¸‹å®éªŒï¼šå¤šæ¬¡è¿è¡Œè¯¥ç®—æ³•ï¼Œæ¯æ¬¡å–çš„ N å€¼ä¸ºå‰ä¸€æ¬¡çš„ä¸¤å€ï¼Œç»Ÿè®¡æ¯æ¬¡æ‰§è¡Œçš„æ—¶é—´ï¼Œå¹¶ç»Ÿè®¡æœ¬æ¬¡è¿è¡Œæ—¶é—´ä¸å‰ä¸€æ¬¡è¿è¡Œæ—¶é—´çš„æ¯”å€¼ï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š

| N | Time(ms) | Ratio |
| :---: | :---: | :---: |
| 500 | 48 | / |
| 1000 | 320 | 6.7 |
| 2000 | 555 | 1.7 |
| 4000 | 4105 | 7.4 |
| 8000 | 33575 | 8.2 |
| 16000 | 268909 | 8.0 |

å¯ä»¥çœ‹åˆ°ï¼ŒT(2N)/T(N) \~ 2<sup>3</sup>ï¼Œå› æ­¤å¯ä»¥ç¡®å®š T(N) \~ aN<sup>3</sup>logNã€‚

```java
public class RatioTest {

    public static void main(String[] args) {
        int N = 500;
        int loopTimes = 7;
        double preTime = -1;
        while (loopTimes-- > 0) {
            int[] nums = new int[N];
            StopWatch.start();
            ThreeSum threeSum = new ThreeSumSlow();
            int cnt = threeSum.count(nums);
            System.out.println(cnt);
            double elapsedTime = StopWatch.elapsedTime();
            double ratio = preTime == -1 ? 0 : elapsedTime / preTime;
            System.out.println(N + "  " + elapsedTime + "  " + ratio);
            preTime = elapsedTime;
            N *= 2;
        }
    }
}
```

```java
public class StopWatch {

    private static long start;


    public static void start() {
        start = System.currentTimeMillis();
    }


    public static double elapsedTime() {
        long now = System.currentTimeMillis();
        return (now - start) / 1000.0;
    }
}
```

# ä¸‰ã€æ’åº

å¾…æ’åºçš„å…ƒç´ éœ€è¦å®ç° Java çš„ Comparable æ¥å£ï¼Œè¯¥æ¥å£æœ‰ compareTo() æ–¹æ³•ï¼Œå¯ä»¥ç”¨å®ƒæ¥åˆ¤æ–­ä¸¤ä¸ªå…ƒç´ çš„å¤§å°å…³ç³»ã€‚

ç ”ç©¶æ’åºç®—æ³•çš„æˆæœ¬æ¨¡å‹æ—¶ï¼Œç»Ÿè®¡çš„æ˜¯æ¯”è¾ƒå’Œäº¤æ¢çš„æ¬¡æ•°ã€‚

ä½¿ç”¨è¾…åŠ©å‡½æ•° less() å’Œ swap() æ¥è¿›è¡Œæ¯”è¾ƒå’Œäº¤æ¢çš„æ“ä½œï¼Œä½¿å¾—ä»£ç çš„å¯è¯»æ€§å’Œå¯ç§»æ¤æ€§æ›´å¥½ã€‚

```java
public abstract class Sort<T extends Comparable<T>> {

    public abstract void sort(T[] nums);

    protected boolean less(T v, T w) {
        return v.compareTo(w) < 0;
    }

    protected void swap(T[] a, int i, int j) {
        T t = a[i];
        a[i] = a[j];
        a[j] = t;
    }
}
```

## é€‰æ‹©æ’åº

é€‰æ‹©å‡ºæ•°ç»„ä¸­çš„æœ€å°å…ƒç´ ï¼Œå°†å®ƒä¸æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ äº¤æ¢ä½ç½®ã€‚å†ä»å‰©ä¸‹çš„å…ƒç´ ä¸­é€‰æ‹©å‡ºæœ€å°çš„å…ƒç´ ï¼Œå°†å®ƒä¸æ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´ äº¤æ¢ä½ç½®ã€‚ä¸æ–­è¿›è¡Œè¿™æ ·çš„æ“ä½œï¼Œç›´åˆ°å°†æ•´ä¸ªæ•°ç»„æ’åºã€‚

é€‰æ‹©æ’åºéœ€è¦ \~N<sup>2</sup>/2 æ¬¡æ¯”è¾ƒå’Œ \~N æ¬¡äº¤æ¢ï¼Œå®ƒçš„è¿è¡Œæ—¶é—´ä¸è¾“å…¥æ— å…³ï¼Œè¿™ä¸ªç‰¹ç‚¹ä½¿å¾—å®ƒå¯¹ä¸€ä¸ªå·²ç»æ’åºçš„æ•°ç»„ä¹Ÿéœ€è¦è¿™ä¹ˆå¤šçš„æ¯”è¾ƒå’Œäº¤æ¢æ“ä½œã€‚

<div align="center"> <img src="pics/37e79a32-95a9-4503-bdb1-159527e628b8.png" width="250"/> </div><br>

```java
public class Selection<T extends Comparable<T>> extends Sort<T> {

    @Override
    public void sort(T[] nums) {
        int N = nums.length;
        for (int i = 0; i < N - 1; i++) {
            int min = i;
            for (int j = i + 1; j < N; j++) {
                if (less(nums[j], nums[min])) {
                    min = j;
                }
            }
            swap(nums, i, min);
        }
    }
}
```

## å†’æ³¡æ’åº

ä»å·¦åˆ°å³ä¸æ–­äº¤æ¢ç›¸é‚»é€†åºçš„å…ƒç´ ï¼Œåœ¨ä¸€è½®çš„å¾ªç¯ä¹‹åï¼Œå¯ä»¥è®©æœªæ’åºçš„æœ€å¤§å…ƒç´ ä¸Šæµ®åˆ°å³ä¾§ã€‚

åœ¨ä¸€è½®å¾ªç¯ä¸­ï¼Œå¦‚æœæ²¡æœ‰å‘ç”Ÿäº¤æ¢ï¼Œå°±è¯´æ˜æ•°ç»„å·²ç»æ˜¯æœ‰åºçš„ï¼Œæ­¤æ—¶å¯ä»¥ç›´æ¥é€€å‡ºã€‚

ä»¥ä¸‹æ¼”ç¤ºäº†åœ¨ä¸€è½®å¾ªç¯ä¸­ï¼Œå°†æœ€å¤§çš„å…ƒç´  5 ä¸Šæµ®åˆ°æœ€å³ä¾§ã€‚

<div align="center"> <img src="pics/1a2f2998-d0da-41c8-8222-1fd95083a66b.png" width="250"/> </div><br>

```java
public class Bubble<T extends Comparable<T>> extends Sort<T> {

    @Override
    public void sort(T[] nums) {
        int N = nums.length;
        boolean hasSorted = false;
        for (int i = N - 1; i > 0 && !hasSorted; i--) {
            hasSorted = true;
            for (int j = 0; j < i; j++) {
                if (less(nums[j + 1], nums[j])) {
                    hasSorted = false;
                    swap(nums, j, j + 1);
                }
            }
        }
    }
}
```

## æ’å…¥æ’åº

æ¯æ¬¡éƒ½å°†å½“å‰å…ƒç´ æ’å…¥åˆ°å·¦ä¾§å·²ç»æ’åºçš„æ•°ç»„ä¸­ï¼Œä½¿å¾—æ’å…¥ä¹‹åå·¦ä¾§æ•°ç»„ä¾ç„¶æœ‰åºã€‚

å¯¹äºæ•°ç»„ {3, 5, 2, 4, 1}ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹é€†åºï¼š(3, 2), (3, 1), (5, 2), (5, 4), (5, 1), (2, 1), (4, 1)ï¼Œæ’å…¥æ’åºæ¯æ¬¡åªèƒ½äº¤æ¢ç›¸é‚»å…ƒç´ ï¼Œä»¤é€†åºæ•°é‡å‡å°‘ 1ï¼Œå› æ­¤æ’å…¥æ’åºéœ€è¦äº¤æ¢çš„æ¬¡æ•°ä¸ºé€†åºæ•°é‡ã€‚

æ’å…¥æ’åºçš„å¤æ‚åº¦å–å†³äºæ•°ç»„çš„åˆå§‹é¡ºåºï¼Œå¦‚æœæ•°ç»„å·²ç»éƒ¨åˆ†æœ‰åºäº†ï¼Œé€†åºè¾ƒå°‘ï¼Œé‚£ä¹ˆæ’å…¥æ’åºä¼šå¾ˆå¿«ã€‚

- å¹³å‡æƒ…å†µä¸‹æ’å…¥æ’åºéœ€è¦ \~N<sup>2</sup>/4 æ¯”è¾ƒä»¥åŠ \~N<sup>2</sup>/4 æ¬¡äº¤æ¢ï¼›
- æœ€åçš„æƒ…å†µä¸‹éœ€è¦ \~N<sup>2</sup>/2 æ¯”è¾ƒä»¥åŠ \~N<sup>2</sup>/2 æ¬¡äº¤æ¢ï¼Œæœ€åçš„æƒ…å†µæ˜¯æ•°ç»„æ˜¯å€’åºçš„ï¼›
- æœ€å¥½çš„æƒ…å†µä¸‹éœ€è¦ N-1 æ¬¡æ¯”è¾ƒå’Œ 0 æ¬¡äº¤æ¢ï¼Œæœ€å¥½çš„æƒ…å†µå°±æ˜¯æ•°ç»„å·²ç»æœ‰åºäº†ã€‚

ä»¥ä¸‹æ¼”ç¤ºäº†åœ¨ä¸€è½®å¾ªç¯ä¸­ï¼Œå°†å…ƒç´  2 æ’å…¥åˆ°å·¦ä¾§å·²ç»æ’åºçš„æ•°ç»„ä¸­ã€‚

<div align="center"> <img src="pics/2a8e1442-2381-4439-a83f-0312c8678b1f.png" width="250"/> </div><br>

```java
public class Insertion<T extends Comparable<T>> extends Sort<T> {

    @Override
    public void sort(T[] nums) {
        int N = nums.length;
        for (int i = 1; i < N; i++) {
            for (int j = i; j > 0 && less(nums[j], nums[j - 1]); j--) {
                swap(nums, j, j - 1);
            }
        }
    }
}
```

## å¸Œå°”æ’åº

å¯¹äºå¤§è§„æ¨¡çš„æ•°ç»„ï¼Œæ’å…¥æ’åºå¾ˆæ…¢ï¼Œå› ä¸ºå®ƒåªèƒ½äº¤æ¢ç›¸é‚»çš„å…ƒç´ ï¼Œæ¯æ¬¡åªèƒ½å°†é€†åºæ•°é‡å‡å°‘ 1ã€‚

å¸Œå°”æ’åºçš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³æ’å…¥æ’åºçš„è¿™ç§å±€é™æ€§ï¼Œå®ƒé€šè¿‡äº¤æ¢ä¸ç›¸é‚»çš„å…ƒç´ ï¼Œæ¯æ¬¡å¯ä»¥å°†é€†åºæ•°é‡å‡å°‘å¤§äº 1ã€‚

å¸Œå°”æ’åºä½¿ç”¨æ’å…¥æ’åºå¯¹é—´éš” h çš„åºåˆ—è¿›è¡Œæ’åºã€‚é€šè¿‡ä¸æ–­å‡å° hï¼Œæœ€åä»¤ h=1ï¼Œå°±å¯ä»¥ä½¿å¾—æ•´ä¸ªæ•°ç»„æ˜¯æœ‰åºçš„ã€‚

<div align="center"> <img src="pics/0157d362-98dd-4e51-ac26-00ecb76beb3e.png" width="500"/> </div><br>

```java
public class Shell<T extends Comparable<T>> extends Sort<T> {

    @Override
    public void sort(T[] nums) {

        int N = nums.length;
        int h = 1;

        while (h < N / 3) {
            h = 3 * h + 1; // 1, 4, 13, 40, ...
        }

        while (h >= 1) {
            for (int i = h; i < N; i++) {
                for (int j = i; j >= h && less(nums[j], nums[j - h]); j -= h) {
                    swap(nums, j, j - h);
                }
            }
            h = h / 3;
        }
    }
}

```

å¸Œå°”æ’åºçš„è¿è¡Œæ—¶é—´è¾¾ä¸åˆ°å¹³æ–¹çº§åˆ«ï¼Œä½¿ç”¨é€’å¢åºåˆ— 1, 4, 13, 40, ...  çš„å¸Œå°”æ’åºæ‰€éœ€è¦çš„æ¯”è¾ƒæ¬¡æ•°ä¸ä¼šè¶…è¿‡ N çš„è‹¥å¹²å€ä¹˜äºé€’å¢åºåˆ—çš„é•¿åº¦ã€‚åé¢ä»‹ç»çš„é«˜çº§æ’åºç®—æ³•åªä¼šæ¯”å¸Œå°”æ’åºå¿«ä¸¤å€å·¦å³ã€‚

## å½’å¹¶æ’åº

å½’å¹¶æ’åºçš„æ€æƒ³æ˜¯å°†æ•°ç»„åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œåˆ†åˆ«è¿›è¡Œæ’åºï¼Œç„¶åå½’å¹¶èµ·æ¥ã€‚

<div align="center"> <img src="pics/220790c6-4377-4a2e-8686-58398afc8a18.png" width="350"/> </div><br>

### 1. å½’å¹¶æ–¹æ³•

å½’å¹¶æ–¹æ³•å°†æ•°ç»„ä¸­ä¸¤ä¸ªå·²ç»æ’åºçš„éƒ¨åˆ†å½’å¹¶æˆä¸€ä¸ªã€‚

```java
public abstract class MergeSort<T extends Comparable<T>> extends Sort<T> {

    protected T[] aux;


    protected void merge(T[] nums, int l, int m, int h) {

        int i = l, j = m + 1;

        for (int k = l; k <= h; k++) {
            aux[k] = nums[k]; // å°†æ•°æ®å¤åˆ¶åˆ°è¾…åŠ©æ•°ç»„
        }

        for (int k = l; k <= h; k++) {
            if (i > m) {
                nums[k] = aux[j++];

            } else if (j > h) {
                nums[k] = aux[i++];

            } else if (aux[i].compareTo(nums[j]) <= 0) {
                nums[k] = aux[i++]; // å…ˆè¿›è¡Œè¿™ä¸€æ­¥ï¼Œä¿è¯ç¨³å®šæ€§

            } else {
                nums[k] = aux[j++];
            }
        }
    }
}
```

### 2. è‡ªé¡¶å‘ä¸‹å½’å¹¶æ’åº

å°†ä¸€ä¸ªå¤§æ•°ç»„åˆ†æˆä¸¤ä¸ªå°æ•°ç»„å»æ±‚è§£ã€‚

å› ä¸ºæ¯æ¬¡éƒ½å°†é—®é¢˜å¯¹åŠåˆ†æˆä¸¤ä¸ªå­é—®é¢˜ï¼Œè¿™ç§å¯¹åŠåˆ†çš„ç®—æ³•å¤æ‚åº¦ä¸€èˆ¬ä¸º O(NlogN)ã€‚

```java
public class Up2DownMergeSort<T extends Comparable<T>> extends MergeSort<T> {

    @Override
    public void sort(T[] nums) {
        aux = (T[]) new Comparable[nums.length];
        sort(nums, 0, nums.length - 1);
    }

    private void sort(T[] nums, int l, int h) {
        if (h <= l) {
            return;
        }
        int mid = l + (h - l) / 2;
        sort(nums, l, mid);
        sort(nums, mid + 1, h);
        merge(nums, l, mid, h);
    }
}
```

### 3. è‡ªåº•å‘ä¸Šå½’å¹¶æ’åº

å…ˆå½’å¹¶é‚£äº›å¾®å‹æ•°ç»„ï¼Œç„¶åæˆå¯¹å½’å¹¶å¾—åˆ°çš„å¾®å‹æ•°ç»„ã€‚

```java
public class Down2UpMergeSort<T extends Comparable<T>> extends MergeSort<T> {

    @Override
    public void sort(T[] nums) {

        int N = nums.length;
        aux = (T[]) new Comparable[N];

        for (int sz = 1; sz < N; sz += sz) {
            for (int lo = 0; lo < N - sz; lo += sz + sz) {
                merge(nums, lo, lo + sz - 1, Math.min(lo + sz + sz - 1, N - 1));
            }
        }
    }
}

```

## å¿«é€Ÿæ’åº

### 1. åŸºæœ¬ç®—æ³•

- å½’å¹¶æ’åºå°†æ•°ç»„åˆ†ä¸ºä¸¤ä¸ªå­æ•°ç»„åˆ†åˆ«æ’åºï¼Œå¹¶å°†æœ‰åºçš„å­æ•°ç»„å½’å¹¶ä½¿å¾—æ•´ä¸ªæ•°ç»„æ’åºï¼›
- å¿«é€Ÿæ’åºé€šè¿‡ä¸€ä¸ªåˆ‡åˆ†å…ƒç´ å°†æ•°ç»„åˆ†ä¸ºä¸¤ä¸ªå­æ•°ç»„ï¼Œå·¦å­æ•°ç»„å°äºç­‰äºåˆ‡åˆ†å…ƒç´ ï¼Œå³å­æ•°ç»„å¤§äºç­‰äºåˆ‡åˆ†å…ƒç´ ï¼Œå°†è¿™ä¸¤ä¸ªå­æ•°ç»„æ’åºä¹Ÿå°±å°†æ•´ä¸ªæ•°ç»„æ’åºäº†ã€‚

<div align="center"> <img src="pics/f8047846-efd4-42be-b6b7-27a7c4998b51.png" width="500"/> </div><br>

```java
public class QuickSort<T extends Comparable<T>> extends Sort<T> {

    @Override
    public void sort(T[] nums) {
        shuffle(nums);
        sort(nums, 0, nums.length - 1);
    }

    private void sort(T[] nums, int l, int h) {
        if (h <= l)
            return;
        int j = partition(nums, l, h);
        sort(nums, l, j - 1);
        sort(nums, j + 1, h);
    }

    private void shuffle(T[] nums) {
        List<Comparable> list = Arrays.asList(nums);
        Collections.shuffle(list);
        list.toArray(nums);
    }
}
```

### 2. åˆ‡åˆ†

å– a[l] ä½œä¸ºåˆ‡åˆ†å…ƒç´ ï¼Œç„¶åä»æ•°ç»„çš„å·¦ç«¯å‘å³æ‰«æç›´åˆ°æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºç­‰äºå®ƒçš„å…ƒç´ ï¼Œå†ä»æ•°ç»„çš„å³ç«¯å‘å·¦æ‰«ææ‰¾åˆ°ç¬¬ä¸€ä¸ªå°äºå®ƒçš„å…ƒç´ ï¼Œäº¤æ¢è¿™ä¸¤ä¸ªå…ƒç´ ã€‚ä¸æ–­è¿›è¡Œè¿™ä¸ªè¿‡ç¨‹ï¼Œå°±å¯ä»¥ä¿è¯å·¦æŒ‡é’ˆ i çš„å·¦ä¾§å…ƒç´ éƒ½ä¸å¤§äºåˆ‡åˆ†å…ƒç´ ï¼Œå³æŒ‡é’ˆ j çš„å³ä¾§å…ƒç´ éƒ½ä¸å°äºåˆ‡åˆ†å…ƒç´ ã€‚å½“ä¸¤ä¸ªæŒ‡é’ˆç›¸é‡æ—¶ï¼Œå°†åˆ‡åˆ†å…ƒç´  a[l] å’Œ a[j] äº¤æ¢ä½ç½®ã€‚

<div align="center"> <img src="pics/766aedd0-1b00-4065-aa2b-7d31138df84f.png" width="400"/> </div><br>

```java
private int partition(T[] nums, int l, int h) {
    int i = l, j = h + 1;
    T v = nums[l];
    while (true) {
        while (less(nums[++i], v) && i != h) ;
        while (less(v, nums[--j]) && j != l) ;
        if (i >= j)
            break;
        swap(nums, i, j);
    }
    swap(nums, l, j);
    return j;
}
```

### 3. æ€§èƒ½åˆ†æ

å¿«é€Ÿæ’åºæ˜¯åŸåœ°æ’åºï¼Œä¸éœ€è¦è¾…åŠ©æ•°ç»„ï¼Œä½†æ˜¯é€’å½’è°ƒç”¨éœ€è¦è¾…åŠ©æ ˆã€‚

å¿«é€Ÿæ’åºæœ€å¥½çš„æƒ…å†µä¸‹æ˜¯æ¯æ¬¡éƒ½æ­£å¥½å°†æ•°ç»„å¯¹åŠåˆ†ï¼Œè¿™æ ·é€’å½’è°ƒç”¨æ¬¡æ•°æ‰æ˜¯æœ€å°‘çš„ã€‚è¿™ç§æƒ…å†µä¸‹æ¯”è¾ƒæ¬¡æ•°ä¸º C<sub>N</sub>=2C<sub>N/2</sub>+Nï¼Œå¤æ‚åº¦ä¸º O(NlogN)ã€‚

æœ€åçš„æƒ…å†µä¸‹ï¼Œç¬¬ä¸€æ¬¡ä»æœ€å°çš„å…ƒç´ åˆ‡åˆ†ï¼Œç¬¬äºŒæ¬¡ä»ç¬¬äºŒå°çš„å…ƒç´ åˆ‡åˆ†ï¼Œå¦‚æ­¤è¿™èˆ¬ã€‚å› æ­¤æœ€åçš„æƒ…å†µä¸‹éœ€è¦æ¯”è¾ƒ N<sup>2</sup>/2ã€‚ä¸ºäº†é˜²æ­¢æ•°ç»„æœ€å¼€å§‹å°±æ˜¯æœ‰åºçš„ï¼Œåœ¨è¿›è¡Œå¿«é€Ÿæ’åºæ—¶éœ€è¦éšæœºæ‰“ä¹±æ•°ç»„ã€‚

### 4. ç®—æ³•æ”¹è¿›

#### 4.1 åˆ‡æ¢åˆ°æ’å…¥æ’åº

å› ä¸ºå¿«é€Ÿæ’åºåœ¨å°æ•°ç»„ä¸­ä¹Ÿä¼šé€’å½’è°ƒç”¨è‡ªå·±ï¼Œå¯¹äºå°æ•°ç»„ï¼Œæ’å…¥æ’åºæ¯”å¿«é€Ÿæ’åºçš„æ€§èƒ½æ›´å¥½ï¼Œå› æ­¤åœ¨å°æ•°ç»„ä¸­å¯ä»¥åˆ‡æ¢åˆ°æ’å…¥æ’åºã€‚

#### 4.2 ä¸‰æ•°å–ä¸­

æœ€å¥½çš„æƒ…å†µä¸‹æ˜¯æ¯æ¬¡éƒ½èƒ½å–æ•°ç»„çš„ä¸­ä½æ•°ä½œä¸ºåˆ‡åˆ†å…ƒç´ ï¼Œä½†æ˜¯è®¡ç®—ä¸­ä½æ•°çš„ä»£ä»·å¾ˆé«˜ã€‚ä¸€ç§æŠ˜ä¸­æ–¹æ³•æ˜¯å– 3 ä¸ªå…ƒç´ ï¼Œå¹¶å°†å¤§å°å±…ä¸­çš„å…ƒç´ ä½œä¸ºåˆ‡åˆ†å…ƒç´ ã€‚

#### 4.3 ä¸‰å‘åˆ‡åˆ†

å¯¹äºæœ‰å¤§é‡é‡å¤å…ƒç´ çš„æ•°ç»„ï¼Œå¯ä»¥å°†æ•°ç»„åˆ‡åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œåˆ†åˆ«å¯¹åº”å°äºã€ç­‰äºå’Œå¤§äºåˆ‡åˆ†å…ƒç´ ã€‚

ä¸‰å‘åˆ‡åˆ†å¿«é€Ÿæ’åºå¯¹äºæœ‰å¤§é‡é‡å¤å…ƒç´ çš„éšæœºæ•°ç»„å¯ä»¥åœ¨çº¿æ€§æ—¶é—´å†…å®Œæˆæ’åºã€‚

```java
public class ThreeWayQuickSort<T extends Comparable<T>> extends QuickSort<T> {

    @Override
    protected void sort(T[] nums, int l, int h) {
        if (h <= l) {
            return;
        }
        int lt = l, i = l + 1, gt = h;
        T v = nums[l];
        while (i <= gt) {
            int cmp = nums[i].compareTo(v);
            if (cmp < 0) {
                swap(nums, lt++, i++);
            } else if (cmp > 0) {
                swap(nums, i, gt--);
            } else {
                i++;
            }
        }
        sort(nums, l, lt - 1);
        sort(nums, gt + 1, h);
    }
}
```

### 5. åŸºäºåˆ‡åˆ†çš„å¿«é€Ÿé€‰æ‹©ç®—æ³•

å¿«é€Ÿæ’åºçš„ partition() æ–¹æ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªæ•´æ•° j ä½¿å¾— a[l..j-1] å°äºç­‰äº a[j]ï¼Œä¸” a[j+1..h] å¤§äºç­‰äº a[j]ï¼Œæ­¤æ—¶ a[j] å°±æ˜¯æ•°ç»„çš„ç¬¬ j å¤§å…ƒç´ ã€‚

å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§æ‰¾å‡ºæ•°ç»„çš„ç¬¬ k ä¸ªå…ƒç´ ã€‚

è¯¥ç®—æ³•æ˜¯çº¿æ€§çº§åˆ«çš„ï¼Œå‡è®¾æ¯æ¬¡èƒ½å°†æ•°ç»„äºŒåˆ†ï¼Œé‚£ä¹ˆæ¯”è¾ƒçš„æ€»æ¬¡æ•°ä¸º (N+N/2+N/4+..)ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¬ k ä¸ªå…ƒç´ ï¼Œè¿™ä¸ªå’Œæ˜¾ç„¶å°äº 2Nã€‚

```java
public T select(T[] nums, int k) {
    int l = 0, h = nums.length - 1;
    while (h > l) {
        int j = partition(nums, l, h);

        if (j == k) {
            return nums[k];

        } else if (j > k) {
            h = j - 1;

        } else {
            l = j + 1;
        }
    }
    return nums[k];
}
```

## å †æ’åº

### 1. å †

å †ä¸­æŸä¸ªèŠ‚ç‚¹çš„å€¼æ€»æ˜¯å¤§äºç­‰äºå…¶å­èŠ‚ç‚¹çš„å€¼ï¼Œå¹¶ä¸”å †æ˜¯ä¸€é¢—å®Œå…¨äºŒå‰æ ‘ã€‚

å †å¯ä»¥ç”¨æ•°ç»„æ¥è¡¨ç¤ºï¼Œè¿™æ˜¯å› ä¸ºå †æ˜¯å®Œå…¨äºŒå‰æ ‘ï¼Œè€Œå®Œå…¨äºŒå‰æ ‘å¾ˆå®¹æ˜“å°±å­˜å‚¨åœ¨æ•°ç»„ä¸­ã€‚ä½ç½® k çš„èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ä½ç½®ä¸º k/2ï¼Œè€Œå®ƒçš„ä¸¤ä¸ªå­èŠ‚ç‚¹çš„ä½ç½®åˆ†åˆ«ä¸º 2k å’Œ 2k+1ã€‚è¿™é‡Œä¸ä½¿ç”¨æ•°ç»„ç´¢å¼•ä¸º 0 çš„ä½ç½®ï¼Œæ˜¯ä¸ºäº†æ›´æ¸…æ™°åœ°æè¿°èŠ‚ç‚¹çš„ä½ç½®å…³ç³»ã€‚

<div align="center"> <img src="pics/f3080f83-6239-459b-8e9c-03b6641f7815.png" width="200"/> </div><br>

```java
public class Heap<T extends Comparable<T>> {

    private T[] heap;
    private int N = 0;

    public Heap(int maxN) {
        this.heap = (T[]) new Comparable[maxN + 1];
    }

    public boolean isEmpty() {
        return N == 0;
    }

    public int size() {
        return N;
    }

    private boolean less(int i, int j) {
        return heap[i].compareTo(heap[j]) < 0;
    }

    private void swap(int i, int j) {
        T t = heap[i];
        heap[i] = heap[j];
        heap[j] = t;
    }
}
```

### 2. ä¸Šæµ®å’Œä¸‹æ²‰

åœ¨å †ä¸­ï¼Œå½“ä¸€ä¸ªèŠ‚ç‚¹æ¯”çˆ¶èŠ‚ç‚¹å¤§ï¼Œé‚£ä¹ˆéœ€è¦äº¤æ¢è¿™ä¸ªä¸¤ä¸ªèŠ‚ç‚¹ã€‚äº¤æ¢åè¿˜å¯èƒ½æ¯”å®ƒæ–°çš„çˆ¶èŠ‚ç‚¹å¤§ï¼Œå› æ­¤éœ€è¦ä¸æ–­åœ°è¿›è¡Œæ¯”è¾ƒå’Œäº¤æ¢æ“ä½œï¼ŒæŠŠè¿™ç§æ“ä½œç§°ä¸ºä¸Šæµ®ã€‚

<div align="center"> <img src="pics/33ac2b23-cb85-4e99-bc41-b7b7199fad1c.png" width="400"/> </div><br>

```java
private void swim(int k) {
    while (k > 1 && less(k / 2, k)) {
        swap(k / 2, k);
        k = k / 2;
    }
}
```

ç±»ä¼¼åœ°ï¼Œå½“ä¸€ä¸ªèŠ‚ç‚¹æ¯”å­èŠ‚ç‚¹æ¥å¾—å°ï¼Œä¹Ÿéœ€è¦ä¸æ–­åœ°å‘ä¸‹è¿›è¡Œæ¯”è¾ƒå’Œäº¤æ¢æ“ä½œï¼ŒæŠŠè¿™ç§æ“ä½œç§°ä¸ºä¸‹æ²‰ã€‚ä¸€ä¸ªèŠ‚ç‚¹å¦‚æœæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼Œåº”å½“ä¸ä¸¤ä¸ªå­èŠ‚ç‚¹ä¸­æœ€å¤§é‚£ä¸ªèŠ‚ç‚¹è¿›è¡Œäº¤æ¢ã€‚

<div align="center"> <img src="pics/72f0ff69-138d-4e54-b7ac-ebe025d978dc.png" width="400"/> </div><br>

```java
private void sink(int k) {
    while (2 * k <= N) {
        int j = 2 * k;
        if (j < N && less(j, j + 1))
            j++;
        if (!less(k, j))
            break;
        swap(k, j);
        k = j;
    }
}
```

### 3. æ’å…¥å…ƒç´ 

å°†æ–°å…ƒç´ æ”¾åˆ°æ•°ç»„æœ«å°¾ï¼Œç„¶åä¸Šæµ®åˆ°åˆé€‚çš„ä½ç½®ã€‚

```java
public void insert(Comparable v) {
    heap[++N] = v;
    swim(N);
}
```

### 4. åˆ é™¤æœ€å¤§å…ƒç´ 

ä»æ•°ç»„é¡¶ç«¯åˆ é™¤æœ€å¤§çš„å…ƒç´ ï¼Œå¹¶å°†æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ æ”¾åˆ°é¡¶ç«¯ï¼Œå¹¶è®©è¿™ä¸ªå…ƒç´ ä¸‹æ²‰åˆ°åˆé€‚çš„ä½ç½®ã€‚

```java
public T delMax() {
    T max = heap[1];
    swap(1, N--);
    heap[N + 1] = null;
    sink(1);
    return max;
}
```

### 5. å †æ’åº

æŠŠæœ€å¤§å…ƒç´ å’Œå½“å‰å †ä¸­æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢ä½ç½®ï¼Œå¹¶ä¸”ä¸åˆ é™¤å®ƒï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªä»å°¾åˆ°å¤´çš„é€’å‡åºåˆ—ï¼Œä»æ­£å‘æ¥çœ‹å°±æ˜¯ä¸€ä¸ªé€’å¢åºåˆ—ï¼Œè¿™å°±æ˜¯å †æ’åºã€‚

#### 5.1 æ„å»ºå †

æ— åºæ•°ç»„å»ºç«‹å †æœ€ç›´æ¥çš„æ–¹æ³•æ˜¯ä»å·¦åˆ°å³éå†æ•°ç»„è¿›è¡Œä¸Šæµ®æ“ä½œã€‚ä¸€ä¸ªæ›´é«˜æ•ˆçš„æ–¹æ³•æ˜¯ä»å³è‡³å·¦è¿›è¡Œä¸‹æ²‰æ“ä½œï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹çš„ä¸¤ä¸ªèŠ‚ç‚¹éƒ½å·²ç»æ˜¯å †æœ‰åºï¼Œé‚£ä¹ˆè¿›è¡Œä¸‹æ²‰æ“ä½œå¯ä»¥ä½¿å¾—è¿™ä¸ªèŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹çš„å †æœ‰åºã€‚å¶å­èŠ‚ç‚¹ä¸éœ€è¦è¿›è¡Œä¸‹æ²‰æ“ä½œï¼Œå¯ä»¥å¿½ç•¥å¶å­èŠ‚ç‚¹çš„å…ƒç´ ï¼Œå› æ­¤åªéœ€è¦éå†ä¸€åŠçš„å…ƒç´ å³å¯ã€‚

<div align="center"> <img src="pics/b84ba6fb-312b-4e69-8c77-fb6eb6fb38d4.png" width="300"/> </div><br>

#### 5.2 äº¤æ¢å †é¡¶å…ƒç´ ä¸æœ€åä¸€ä¸ªå…ƒç´ 

äº¤æ¢ä¹‹åéœ€è¦è¿›è¡Œä¸‹æ²‰æ“ä½œç»´æŒå †çš„æœ‰åºçŠ¶æ€ã€‚

<div align="center"> <img src="pics/51fb761d-8ce0-4472-92ff-2f227ac7888a.png" width="270"/> </div><br>

<div align="center"> <img src="pics/b20a3466-44b4-445e-87c7-dd4fb9ef44b2.png" width="350"/> </div><br>

```java
public class HeapSort<T extends Comparable<T>> extends Sort<T> {
    /**
     * æ•°ç»„ç¬¬ 0 ä¸ªä½ç½®ä¸èƒ½æœ‰å…ƒç´ 
     */
    @Override
    public void sort(T[] nums) {
        int N = nums.length - 1;
        for (int k = N / 2; k >= 1; k--)
            sink(nums, k, N);

        while (N > 1) {
            swap(nums, 1, N--);
            sink(nums, 1, N);
        }
    }

    private void sink(T[] nums, int k, int N) {
        while (2 * k <= N) {
            int j = 2 * k;
            if (j < N && less(nums, j, j + 1))
                j++;
            if (!less(nums, k, j))
                break;
            swap(nums, k, j);
            k = j;
        }
    }

    private boolean less(T[] nums, int i, int j) {
        return nums[i].compareTo(nums[j]) < 0;
    }
}
```

### 6. åˆ†æ

ä¸€ä¸ªå †çš„é«˜åº¦ä¸º logNï¼Œå› æ­¤åœ¨å †ä¸­æ’å…¥å…ƒç´ å’Œåˆ é™¤æœ€å¤§å…ƒç´ çš„å¤æ‚åº¦éƒ½ä¸º logNã€‚

å¯¹äºå †æ’åºï¼Œç”±äºè¦å¯¹ N ä¸ªèŠ‚ç‚¹è¿›è¡Œä¸‹æ²‰æ“ä½œï¼Œå› æ­¤å¤æ‚åº¦ä¸º NlogNã€‚

å †æ’åºæ˜¯ä¸€ç§åŸåœ°æ’åºï¼Œæ²¡æœ‰åˆ©ç”¨é¢å¤–çš„ç©ºé—´ã€‚

ç°ä»£æ“ä½œç³»ç»Ÿå¾ˆå°‘ä½¿ç”¨å †æ’åºï¼Œå› ä¸ºå®ƒæ— æ³•åˆ©ç”¨å±€éƒ¨æ€§åŸç†è¿›è¡Œç¼“å­˜ï¼Œä¹Ÿå°±æ˜¯æ•°ç»„å…ƒç´ å¾ˆå°‘å’Œç›¸é‚»çš„å…ƒç´ è¿›è¡Œæ¯”è¾ƒå’Œäº¤æ¢ã€‚

## å°ç»“

### 1. æ’åºç®—æ³•çš„æ¯”è¾ƒ

| ç®—æ³• | ç¨³å®šæ€§ | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ | å¤‡æ³¨ |
| :---: | :---: |:---: | :---: | :---: |
| é€‰æ‹©æ’åº | Ã— | N<sup>2</sup> | 1 | |
| å†’æ³¡æ’åº | âˆš |  N<sup>2</sup> | 1 | |
| æ’å…¥æ’åº | âˆš |  N \~ N<sup>2</sup> | 1 | æ—¶é—´å¤æ‚åº¦å’Œåˆå§‹é¡ºåºæœ‰å…³ |
| å¸Œå°”æ’åº | Ã—  |  N çš„è‹¥å¹²å€ä¹˜äºé€’å¢åºåˆ—çš„é•¿åº¦ | 1 | æ”¹è¿›ç‰ˆæ’å…¥æ’åº |
| å¿«é€Ÿæ’åº | Ã—  | NlogN | logN | |
| ä¸‰å‘åˆ‡åˆ†å¿«é€Ÿæ’åº | Ã—  |  N \~ NlogN | logN | é€‚ç”¨äºæœ‰å¤§é‡é‡å¤ä¸»é”®|
| å½’å¹¶æ’åº | âˆš |  NlogN | N | |
| å †æ’åº | Ã—  |  NlogN | 1 | æ— æ³•åˆ©ç”¨å±€éƒ¨æ€§åŸç†|

å¿«é€Ÿæ’åºæ˜¯æœ€å¿«çš„é€šç”¨æ’åºç®—æ³•ï¼Œå®ƒçš„å†…å¾ªç¯çš„æŒ‡ä»¤å¾ˆå°‘ï¼Œè€Œä¸”å®ƒè¿˜èƒ½åˆ©ç”¨ç¼“å­˜ï¼Œå› ä¸ºå®ƒæ€»æ˜¯é¡ºåºåœ°è®¿é—®æ•°æ®ã€‚å®ƒçš„è¿è¡Œæ—¶é—´è¿‘ä¼¼ä¸º \~cNlogNï¼Œè¿™é‡Œçš„ c æ¯”å…¶å®ƒçº¿æ€§å¯¹æ•°çº§åˆ«çš„æ’åºç®—æ³•éƒ½è¦å°ã€‚

ä½¿ç”¨ä¸‰å‘åˆ‡åˆ†å¿«é€Ÿæ’åºï¼Œå®é™…åº”ç”¨ä¸­å¯èƒ½å‡ºç°çš„æŸäº›åˆ†å¸ƒçš„è¾“å…¥èƒ½å¤Ÿè¾¾åˆ°çº¿æ€§çº§åˆ«ï¼Œè€Œå…¶å®ƒæ’åºç®—æ³•ä»ç„¶éœ€è¦çº¿æ€§å¯¹æ•°æ—¶é—´ã€‚

### 2. Java çš„æ’åºç®—æ³•å®ç°

Java ä¸»è¦æ’åºæ–¹æ³•ä¸º java.util.Arrays.sort()ï¼Œå¯¹äºåŸå§‹æ•°æ®ç±»å‹ä½¿ç”¨ä¸‰å‘åˆ‡åˆ†çš„å¿«é€Ÿæ’åºï¼Œå¯¹äºå¼•ç”¨ç±»å‹ä½¿ç”¨å½’å¹¶æ’åºã€‚

# å››ã€å¹¶æŸ¥é›†

ç”¨äºè§£å†³åŠ¨æ€è¿é€šæ€§é—®é¢˜ï¼Œèƒ½åŠ¨æ€è¿æ¥ä¸¤ä¸ªç‚¹ï¼Œå¹¶ä¸”åˆ¤æ–­ä¸¤ä¸ªç‚¹æ˜¯å¦è¿é€šã€‚

<div align="center"> <img src="pics/9d0a637c-6a8f-4f5a-99b9-fdcfa26793ff.png" width="400"/> </div><br>

| æ–¹æ³• | æè¿° |
| :---: | :---: |
| UF(int N) | æ„é€ ä¸€ä¸ªå¤§å°ä¸º N çš„å¹¶æŸ¥é›† |
| void union(int p, int q) | è¿æ¥ p å’Œ q èŠ‚ç‚¹ |
| int find(int p) | æŸ¥æ‰¾ p æ‰€åœ¨çš„è¿é€šåˆ†é‡ç¼–å· |
| boolean connected(int p, int q) | åˆ¤æ–­ p å’Œ q èŠ‚ç‚¹æ˜¯å¦è¿é€š |

```java
public abstract class UF {

    protected int[] id;

    public UF(int N) {
        id = new int[N];
        for (int i = 0; i < N; i++) {
            id[i] = i;
        }
    }

    public boolean connected(int p, int q) {
        return find(p) == find(q);
    }

    public abstract int find(int p);

    public abstract void union(int p, int q);
}
```

## Quick Find

å¯ä»¥å¿«é€Ÿè¿›è¡Œ find æ“ä½œï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å¿«é€Ÿåˆ¤æ–­ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦è¿é€šã€‚

éœ€è¦ä¿è¯åŒä¸€è¿é€šåˆ†é‡çš„æ‰€æœ‰èŠ‚ç‚¹çš„ id å€¼ç›¸ç­‰ã€‚

ä½†æ˜¯ union æ“ä½œä»£ä»·å´å¾ˆé«˜ï¼Œéœ€è¦å°†å…¶ä¸­ä¸€ä¸ªè¿é€šåˆ†é‡ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ id å€¼éƒ½ä¿®æ”¹ä¸ºå¦ä¸€ä¸ªèŠ‚ç‚¹çš„ id å€¼ã€‚

<div align="center"> <img src="pics/8f0cc500-5994-4c7a-91a9-62885d658662.png" width="350"/> </div><br>

```java
public class QuickFindUF extends UF {

    public QuickFindUF(int N) {
        super(N);
    }


    @Override
    public int find(int p) {
        return id[p];
    }


    @Override
    public void union(int p, int q) {
        int pID = find(p);
        int qID = find(q);

        if (pID == qID) {
            return;
        }

        for (int i = 0; i < id.length; i++) {
            if (id[i] == pID) {
                id[i] = qID;
            }
        }
    }
}
```

## Quick Union

å¯ä»¥å¿«é€Ÿè¿›è¡Œ union æ“ä½œï¼Œåªéœ€è¦ä¿®æ”¹ä¸€ä¸ªèŠ‚ç‚¹çš„ id å€¼å³å¯ã€‚

ä½†æ˜¯ find æ“ä½œå¼€é”€å¾ˆå¤§ï¼Œå› ä¸ºåŒä¸€ä¸ªè¿é€šåˆ†é‡çš„èŠ‚ç‚¹ id å€¼ä¸åŒï¼Œid å€¼åªæ˜¯ç”¨æ¥æŒ‡å‘å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚å› æ­¤éœ€è¦ä¸€ç›´å‘ä¸ŠæŸ¥æ‰¾æ“ä½œï¼Œç›´åˆ°æ‰¾åˆ°æœ€ä¸Šå±‚çš„èŠ‚ç‚¹ã€‚

<div align="center"> <img src="pics/5d4a5181-65fb-4bf2-a9c6-899cab534b44.png" width="350"/> </div><br>

```java
public class QuickUnionUF extends UF {

    public QuickUnionUF(int N) {
        super(N);
    }


    @Override
    public int find(int p) {
        while (p != id[p]) {
            p = id[p];
        }
        return p;
    }


    @Override
    public void union(int p, int q) {
        int pRoot = find(p);
        int qRoot = find(q);

        if (pRoot != qRoot) {
            id[pRoot] = qRoot;
        }
    }
}
```

è¿™ç§æ–¹æ³•å¯ä»¥å¿«é€Ÿè¿›è¡Œ union æ“ä½œï¼Œä½†æ˜¯ find æ“ä½œå’Œæ ‘é«˜æˆæ­£æ¯”ï¼Œæœ€åçš„æƒ…å†µä¸‹æ ‘çš„é«˜åº¦ä¸ºèŠ‚ç‚¹çš„æ•°ç›®ã€‚

<div align="center"> <img src="pics/bfbb11e2-d208-4efa-b97b-24cd40467cd8.png" width="130"/> </div><br>

## åŠ æƒ Quick Union

ä¸ºäº†è§£å†³ quick-union çš„æ ‘é€šå¸¸ä¼šå¾ˆé«˜çš„é—®é¢˜ï¼ŒåŠ æƒ quick-union åœ¨ union æ“ä½œæ—¶ä¼šè®©è¾ƒå°çš„æ ‘è¿æ¥è¾ƒå¤§çš„æ ‘ä¸Šé¢ã€‚

ç†è®ºç ”ç©¶è¯æ˜ï¼ŒåŠ æƒ quick-union ç®—æ³•æ„é€ çš„æ ‘æ·±åº¦æœ€å¤šä¸è¶…è¿‡ logNã€‚

<div align="center"> <img src="pics/a4c17d43-fa5e-4935-b74e-147e7f7e782c.png" width="170"/> </div><br>

```java
public class WeightedQuickUnionUF extends UF {

    // ä¿å­˜èŠ‚ç‚¹çš„æ•°é‡ä¿¡æ¯
    private int[] sz;


    public WeightedQuickUnionUF(int N) {
        super(N);
        this.sz = new int[N];
        for (int i = 0; i < N; i++) {
            this.sz[i] = 1;
        }
    }


    @Override
    public int find(int p) {
        while (p != id[p]) {
            p = id[p];
        }
        return p;
    }


    @Override
    public void union(int p, int q) {

        int i = find(p);
        int j = find(q);

        if (i == j) return;

        if (sz[i] < sz[j]) {
            id[i] = j;
            sz[j] += sz[i];
        } else {
            id[j] = i;
            sz[i] += sz[j];
        }
    }
}
```

## è·¯å¾„å‹ç¼©çš„åŠ æƒ Quick Union

åœ¨æ£€æŸ¥èŠ‚ç‚¹çš„åŒæ—¶å°†å®ƒä»¬ç›´æ¥é“¾æ¥åˆ°æ ¹èŠ‚ç‚¹ï¼Œåªéœ€è¦åœ¨ find ä¸­æ·»åŠ ä¸€ä¸ªå¾ªç¯å³å¯ã€‚

## æ¯”è¾ƒ

| ç®—æ³• | union | find |
| :---: | :---: | :---: |
| Quick Find | N | 1 |
| Quick Union | æ ‘é«˜ | æ ‘é«˜ |
| åŠ æƒ Quick Union | logN | logN |
| è·¯å¾„å‹ç¼©çš„åŠ æƒ Quick Union | éå¸¸æ¥è¿‘ 1 | éå¸¸æ¥è¿‘ 1 |

# äº”ã€æ ˆå’Œé˜Ÿåˆ—

## æ ˆ

```java
public interface MyStack<Item> extends Iterable<Item> {

    MyStack<Item> push(Item item);

    Item pop() throws Exception;

    boolean isEmpty();

    int size();

}
```

### 1. æ•°ç»„å®ç°

```java
public class ArrayStack<Item> implements MyStack<Item> {

    // æ ˆå…ƒç´ æ•°ç»„ï¼Œåªèƒ½é€šè¿‡è½¬å‹æ¥åˆ›å»ºæ³›å‹æ•°ç»„
    private Item[] a = (Item[]) new Object[1];

    // å…ƒç´ æ•°é‡
    private int N = 0;


    @Override
    public MyStack<Item> push(Item item) {
        check();
        a[N++] = item;
        return this;
    }


    @Override
    public Item pop() throws Exception {

        if (isEmpty()) {
            throw new Exception("stack is empty");
        }

        Item item = a[--N];

        check();

        // é¿å…å¯¹è±¡æ¸¸ç¦»
        a[N] = null;

        return item;
    }


    private void check() {

        if (N >= a.length) {
            resize(2 * a.length);

        } else if (N > 0 && N <= a.length / 4) {
            resize(a.length / 2);
        }
    }


    /**
     * è°ƒæ•´æ•°ç»„å¤§å°ï¼Œä½¿å¾—æ ˆå…·æœ‰ä¼¸ç¼©æ€§
     */
    private void resize(int size) {

        Item[] tmp = (Item[]) new Object[size];

        for (int i = 0; i < N; i++) {
            tmp[i] = a[i];
        }

        a = tmp;
    }


    @Override
    public boolean isEmpty() {
        return N == 0;
    }


    @Override
    public int size() {
        return N;
    }


    @Override
    public Iterator<Item> iterator() {

        // è¿”å›é€†åºéå†çš„è¿­ä»£å™¨
        return new Iterator<Item>() {

            private int i = N;

            @Override
            public boolean hasNext() {
                return i > 0;
            }

            @Override
            public Item next() {
                return a[--i];
            }
        };

    }
}
```

### 2. é“¾è¡¨å®ç°

éœ€è¦ä½¿ç”¨é“¾è¡¨çš„å¤´æ’æ³•æ¥å®ç°ï¼Œå› ä¸ºå¤´æ’æ³•ä¸­æœ€åå‹å…¥æ ˆçš„å…ƒç´ åœ¨é“¾è¡¨çš„å¼€å¤´ï¼Œå®ƒçš„ next æŒ‡é’ˆæŒ‡å‘å‰ä¸€ä¸ªå‹å…¥æ ˆçš„å…ƒç´ ï¼Œåœ¨å¼¹å‡ºå…ƒç´ æ—¶å°±å¯ä»¥é€šè¿‡ next æŒ‡é’ˆéå†åˆ°å‰ä¸€ä¸ªå‹å…¥æ ˆçš„å…ƒç´ ä»è€Œè®©è¿™ä¸ªå…ƒç´ æˆä¸ºæ–°çš„æ ˆé¡¶å…ƒç´ ã€‚

```java
public class ListStack<Item> implements MyStack<Item> {

    private Node top = null;
    private int N = 0;


    private class Node {
        Item item;
        Node next;
    }


    @Override
    public MyStack<Item> push(Item item) {

        Node newTop = new Node();

        newTop.item = item;
        newTop.next = top;

        top = newTop;

        N++;

        return this;
    }


    @Override
    public Item pop() throws Exception {

        if (isEmpty()) {
            throw new Exception("stack is empty");
        }

        Item item = top.item;

        top = top.next;
        N--;

        return item;
    }


    @Override
    public boolean isEmpty() {
        return N == 0;
    }


    @Override
    public int size() {
        return N;
    }


    @Override
    public Iterator<Item> iterator() {

        return new Iterator<Item>() {

            private Node cur = top;


            @Override
            public boolean hasNext() {
                return cur != null;
            }


            @Override
            public Item next() {
                Item item = cur.item;
                cur = cur.next;
                return item;
            }
        };

    }
}
```

## é˜Ÿåˆ—

ä¸‹é¢æ˜¯é˜Ÿåˆ—çš„é“¾è¡¨å®ç°ï¼Œéœ€è¦ç»´æŠ¤ first å’Œ last èŠ‚ç‚¹æŒ‡é’ˆï¼Œåˆ†åˆ«æŒ‡å‘é˜Ÿé¦–å’Œé˜Ÿå°¾ã€‚

è¿™é‡Œéœ€è¦è€ƒè™‘ first å’Œ last æŒ‡é’ˆå“ªä¸ªä½œä¸ºé“¾è¡¨çš„å¼€å¤´ã€‚å› ä¸ºå‡ºé˜Ÿåˆ—æ“ä½œéœ€è¦è®©é˜Ÿé¦–å…ƒç´ çš„ä¸‹ä¸€ä¸ªå…ƒç´ æˆä¸ºé˜Ÿé¦–ï¼Œæ‰€ä»¥éœ€è¦å®¹æ˜“è·å–ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œè€Œé“¾è¡¨çš„å¤´éƒ¨èŠ‚ç‚¹çš„ next æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå› æ­¤å¯ä»¥è®© first æŒ‡é’ˆé“¾è¡¨çš„å¼€å¤´ã€‚

```java
public interface MyQueue<Item> extends Iterable<Item> {

    int size();

    boolean isEmpty();

    MyQueue<Item> add(Item item);

    Item remove() throws Exception;
}
```

```java
public class ListQueue<Item> implements MyQueue<Item> {

    private Node first;
    private Node last;
    int N = 0;


    private class Node {
        Item item;
        Node next;
    }


    @Override
    public boolean isEmpty() {
        return N == 0;
    }


    @Override
    public int size() {
        return N;
    }


    @Override
    public MyQueue<Item> add(Item item) {

        Node newNode = new Node();
        newNode.item = item;
        newNode.next = null;

        if (isEmpty()) {
            last = newNode;
            first = newNode;
        } else {
            last.next = newNode;
            last = newNode;
        }

        N++;
        return this;
    }


    @Override
    public Item remove() throws Exception {

        if (isEmpty()) {
            throw new Exception("queue is empty");
        }

        Node node = first;
        first = first.next;
        N--;

        if (isEmpty()) {
            last = null;
        }

        return node.item;
    }


    @Override
    public Iterator<Item> iterator() {

        return new Iterator<Item>() {

            Node cur = first;


            @Override
            public boolean hasNext() {
                return cur != null;
            }


            @Override
            public Item next() {
                Item item = cur.item;
                cur = cur.next;
                return item;
            }
        };
    }
}
```





# å…­ã€ç¬¦å·è¡¨

ç¬¦å·è¡¨ï¼ˆSymbol Tableï¼‰æ˜¯ä¸€ç§å­˜å‚¨é”®å€¼å¯¹çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥æ”¯æŒå¿«é€ŸæŸ¥æ‰¾æ“ä½œã€‚

ç¬¦å·è¡¨åˆ†ä¸ºæœ‰åºå’Œæ— åºä¸¤ç§ï¼Œæœ‰åºç¬¦å·è¡¨ä¸»è¦æŒ‡æ”¯æŒ min()ã€max() ç­‰æ ¹æ®é”®çš„å¤§å°å…³ç³»æ¥å®ç°çš„æ“ä½œã€‚

æœ‰åºç¬¦å·è¡¨çš„é”®éœ€è¦å®ç° Comparable æ¥å£ã€‚

```java
public interface UnorderedST<Key, Value> {

    int size();

    Value get(Key key);

    void put(Key key, Value value);

    void delete(Key key);
}
```

```java
public interface OrderedST<Key extends Comparable<Key>, Value> {

    int size();

    void put(Key key, Value value);

    Value get(Key key);

    Key min();

    Key max();

    int rank(Key key);

    List<Key> keys(Key l, Key h);
}
```

## åˆçº§å®ç°

### 1. é“¾è¡¨å®ç°æ— åºç¬¦å·è¡¨

```java
public class ListUnorderedST<Key, Value> implements UnorderedST<Key, Value> {

    private Node first;

    private class Node {
        Key key;
        Value value;
        Node next;

        Node(Key key, Value value, Node next) {
            this.key = key;
            this.value = value;
            this.next = next;
        }
    }

    @Override
    public int size() {
        int cnt = 0;
        Node cur = first;
        while (cur != null) {
            cnt++;
            cur = cur.next;
        }
        return cnt;
    }

    @Override
    public void put(Key key, Value value) {
        Node cur = first;
        // å¦‚æœåœ¨é“¾è¡¨ä¸­æ‰¾åˆ°èŠ‚ç‚¹çš„é”®ç­‰äº key å°±æ›´æ–°è¿™ä¸ªèŠ‚ç‚¹çš„å€¼ä¸º value
        while (cur != null) {
            if (cur.key.equals(key)) {
                cur.value = value;
                return;
            }
            cur = cur.next;
        }
        // å¦åˆ™ä½¿ç”¨å¤´æ’æ³•æ’å…¥ä¸€ä¸ªæ–°èŠ‚ç‚¹
        first = new Node(key, value, first);
    }

    @Override
    public void delete(Key key) {
        if (first == null)
            return;
        if (first.key.equals(key))
            first = first.next;
        Node pre = first, cur = first.next;
        while (cur != null) {
            if (cur.key.equals(key)) {
                pre.next = cur.next;
                return;
            }
            pre = pre.next;
            cur = cur.next;
        }
    }

    @Override
    public Value get(Key key) {
        Node cur = first;
        while (cur != null) {
            if (cur.key.equals(key))
                return cur.value;
            cur = cur.next;
        }
        return null;
    }
}
```

### 2. äºŒåˆ†æŸ¥æ‰¾å®ç°æœ‰åºç¬¦å·è¡¨

ä½¿ç”¨ä¸€å¯¹å¹³è¡Œæ•°ç»„ï¼Œä¸€ä¸ªå­˜å‚¨é”®ä¸€ä¸ªå­˜å‚¨å€¼ã€‚

äºŒåˆ†æŸ¥æ‰¾çš„ rank() æ–¹æ³•è‡³å…³é‡è¦ï¼Œå½“é”®åœ¨è¡¨ä¸­æ—¶ï¼Œå®ƒèƒ½å¤ŸçŸ¥é“è¯¥é”®çš„ä½ç½®ï¼›å½“é”®ä¸åœ¨è¡¨ä¸­æ—¶ï¼Œå®ƒä¹Ÿèƒ½çŸ¥é“åœ¨ä½•å¤„æ’å…¥æ–°é”®ã€‚

äºŒåˆ†æŸ¥æ‰¾æœ€å¤šéœ€è¦ logN+1 æ¬¡æ¯”è¾ƒï¼Œä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾å®ç°çš„ç¬¦å·è¡¨çš„æŸ¥æ‰¾æ“ä½œæ‰€éœ€è¦çš„æ—¶é—´æœ€å¤šæ˜¯å¯¹æ•°çº§åˆ«çš„ã€‚ä½†æ˜¯æ’å…¥æ“ä½œéœ€è¦ç§»åŠ¨æ•°ç»„å…ƒç´ ï¼Œæ˜¯çº¿æ€§çº§åˆ«çš„ã€‚

```java
public class BinarySearchOrderedST<Key extends Comparable<Key>, Value> implements OrderedST<Key, Value> {

    private Key[] keys;
    private Value[] values;
    private int N = 0;

    public BinarySearchOrderedST(int capacity) {
        keys = (Key[]) new Comparable[capacity];
        values = (Value[]) new Object[capacity];
    }

    @Override
    public int size() {
        return N;
    }

    @Override
    public int rank(Key key) {
        int l = 0, h = N - 1;
        while (l <= h) {
            int m = l + (h - l) / 2;
            int cmp = key.compareTo(keys[m]);
            if (cmp == 0)
                return m;
            else if (cmp < 0)
                h = m - 1;
            else
                l = m + 1;
        }
        return l;
    }

    @Override
    public List<Key> keys(Key l, Key h) {
        int index = rank(l);
        List<Key> list = new ArrayList<>();
        while (keys[index].compareTo(h) <= 0) {
            list.add(keys[index]);
            index++;
        }
        return list;
    }

    @Override
    public void put(Key key, Value value) {
        int index = rank(key);
        // å¦‚æœæ‰¾åˆ°å·²ç»å­˜åœ¨çš„èŠ‚ç‚¹é”®ä¸º keyï¼Œå°±æ›´æ–°è¿™ä¸ªèŠ‚ç‚¹çš„å€¼ä¸º value
        if (index < N && keys[index].compareTo(key) == 0) {
            values[index] = value;
            return;
        }
        // å¦åˆ™åœ¨æ•°ç»„ä¸­æ’å…¥æ–°çš„èŠ‚ç‚¹ï¼Œéœ€è¦å…ˆå°†æ’å…¥ä½ç½®ä¹‹åçš„å…ƒç´ éƒ½å‘åç§»åŠ¨ä¸€ä¸ªä½ç½®
        for (int j = N; j > index; j--) {
            keys[j] = keys[j - 1];
            values[j] = values[j - 1];
        }
        keys[index] = key;
        values[index] = value;
        N++;
    }

    @Override
    public Value get(Key key) {
        int index = rank(key);
        if (index < N && keys[index].compareTo(key) == 0)
            return values[index];
        return null;
    }

    @Override
    public Key min() {
        return keys[0];
    }

    @Override
    public Key max() {
        return keys[N - 1];
    }
}
```

## äºŒå‰æŸ¥æ‰¾æ ‘

**äºŒå‰æ ‘**  æ˜¯ä¸€ä¸ªç©ºé“¾æ¥ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªæœ‰å·¦å³ä¸¤ä¸ªé“¾æ¥çš„èŠ‚ç‚¹ï¼Œæ¯ä¸ªé“¾æ¥éƒ½æŒ‡å‘ä¸€é¢—å­äºŒå‰æ ‘ã€‚

<div align="center"> <img src="pics/f9f9f993-8ece-4da7-b848-af9b438fad76.png" width="200"/> </div><br>

**äºŒå‰æŸ¥æ‰¾æ ‘** ï¼ˆBSTï¼‰æ˜¯ä¸€é¢—äºŒå‰æ ‘ï¼Œå¹¶ä¸”æ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å¤§äºç­‰äºå…¶å·¦å­æ ‘ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹çš„å€¼è€Œå°äºç­‰äºå³å­æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹çš„å€¼ã€‚

<div align="center"> <img src="pics/8ae4550b-f0cb-4e4d-9e2b-c550538bf230.png" width="200"/> </div><br>

BST æœ‰ä¸€ä¸ªé‡è¦æ€§è´¨ï¼Œå°±æ˜¯å®ƒçš„ä¸­åºéå†ç»“æœé€’å¢æ’åºã€‚

<div align="center"> <img src="pics/fbe54203-c005-48f0-8883-b05e564a3173.png" width="200"/> </div><br>

åŸºæœ¬æ•°æ®ç»“æ„ï¼š

```java
public class BST<Key extends Comparable<Key>, Value> implements OrderedST<Key, Value> {

    protected Node root;

    protected class Node {
        Key key;
        Value val;
        Node left;
        Node right;
        // ä»¥è¯¥èŠ‚ç‚¹ä¸ºæ ¹çš„å­æ ‘èŠ‚ç‚¹æ€»æ•°
        int N;
        // çº¢é»‘æ ‘ä¸­ä½¿ç”¨
        boolean color;

        Node(Key key, Value val, int N) {
            this.key = key;
            this.val = val;
            this.N = N;
        }
    }

    @Override
    public int size() {
        return size(root);
    }

    private int size(Node x) {
        if (x == null)
            return 0;
        return x.N;
    }

    protected void recalculateSize(Node x) {
        x.N = size(x.left) + size(x.right) + 1;
    }
}
```

ä¸ºäº†æ–¹ä¾¿ç»˜å›¾ï¼Œä¸‹æ–‡ä¸­äºŒå‰æ ‘çš„ç©ºé“¾æ¥ä¸ç”»å‡ºæ¥ã€‚

### 1. get()

- å¦‚æœæ ‘æ˜¯ç©ºçš„ï¼Œåˆ™æŸ¥æ‰¾æœªå‘½ä¸­ï¼›
- å¦‚æœè¢«æŸ¥æ‰¾çš„é”®å’Œæ ¹èŠ‚ç‚¹çš„é”®ç›¸ç­‰ï¼ŒæŸ¥æ‰¾å‘½ä¸­ï¼›
- å¦åˆ™é€’å½’åœ°åœ¨å­æ ‘ä¸­æŸ¥æ‰¾ï¼šå¦‚æœè¢«æŸ¥æ‰¾çš„é”®è¾ƒå°å°±åœ¨å·¦å­æ ‘ä¸­æŸ¥æ‰¾ï¼Œè¾ƒå¤§å°±åœ¨å³å­æ ‘ä¸­æŸ¥æ‰¾ã€‚

```java
@Override
public Value get(Key key) {
    return get(root, key);
}

private Value get(Node x, Key key) {
    if (x == null)
        return null;
    int cmp = key.compareTo(x.key);
    if (cmp == 0)
        return x.val;
    else if (cmp < 0)
        return get(x.left, key);
    else
        return get(x.right, key);
}
```

### 2. put()

å½“æ’å…¥çš„é”®ä¸å­˜åœ¨äºæ ‘ä¸­ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œå¹¶ä¸”æ›´æ–°ä¸Šå±‚èŠ‚ç‚¹çš„é“¾æ¥æŒ‡å‘è¯¥èŠ‚ç‚¹ï¼Œä½¿å¾—è¯¥èŠ‚ç‚¹æ­£ç¡®åœ°é“¾æ¥åˆ°æ ‘ä¸­ã€‚

<div align="center"> <img src="pics/107a6a2b-f15b-4cad-bced-b7fb95258c9c.png" width="200"/> </div><br>

```java
 @Override
public void put(Key key, Value value) {
    root = put(root, key, value);
}

private Node put(Node x, Key key, Value value) {
    if (x == null)
        return new Node(key, value, 1);
    int cmp = key.compareTo(x.key);
    if (cmp == 0)
        x.val = value;
    else if (cmp < 0)
        x.left = put(x.left, key, value);
    else
        x.right = put(x.right, key, value);
    recalculateSize(x);
    return x;
}
```

### 3. åˆ†æ

äºŒå‰æŸ¥æ‰¾æ ‘çš„ç®—æ³•è¿è¡Œæ—¶é—´å–å†³äºæ ‘çš„å½¢çŠ¶ï¼Œè€Œæ ‘çš„å½¢çŠ¶åˆå–å†³äºé”®è¢«æ’å…¥çš„å…ˆåé¡ºåºã€‚

æœ€å¥½çš„æƒ…å†µä¸‹æ ‘æ˜¯å®Œå…¨å¹³è¡¡çš„ï¼Œæ¯æ¡ç©ºé“¾æ¥å’Œæ ¹èŠ‚ç‚¹çš„è·ç¦»éƒ½ä¸º logNã€‚

<div align="center"> <img src="pics/4d741402-344d-4b7c-be01-e57184bcad0e.png" width="200"/> </div><br>

åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œæ ‘çš„é«˜åº¦ä¸º Nã€‚

<div align="center"> <img src="pics/be7dca03-12ec-456b-8b54-b1b3161f5531.png" width="200"/> </div><br>

### 4. floor()

floor(key)ï¼šå°äºç­‰äºé”®çš„æœ€å¤§é”®

- å¦‚æœé”®å°äºæ ¹èŠ‚ç‚¹çš„é”®ï¼Œé‚£ä¹ˆ floor(key) ä¸€å®šåœ¨å·¦å­æ ‘ä¸­ï¼›
- å¦‚æœé”®å¤§äºæ ¹èŠ‚ç‚¹çš„é”®ï¼Œéœ€è¦å…ˆåˆ¤æ–­å³å­æ ‘ä¸­æ˜¯å¦å­˜åœ¨ floor(key)ï¼Œå¦‚æœå­˜åœ¨å°±è¿”å›ï¼Œå¦åˆ™æ ¹èŠ‚ç‚¹å°±æ˜¯ floor(key)ã€‚

```java
public Key floor(Key key) {
    Node x = floor(root, key);
    if (x == null)
        return null;
    return x.key;
}

private Node floor(Node x, Key key) {
    if (x == null)
        return null;
    int cmp = key.compareTo(x.key);
    if (cmp == 0)
        return x;
    if (cmp < 0)
        return floor(x.left, key);
    Node t = floor(x.right, key);
    return t != null ? t : x;
}
```

### 5. rank()

rank(key) è¿”å› key çš„æ’åã€‚

- å¦‚æœé”®å’Œæ ¹èŠ‚ç‚¹çš„é”®ç›¸ç­‰ï¼Œè¿”å›å·¦å­æ ‘çš„èŠ‚ç‚¹æ•°ï¼›
- å¦‚æœå°äºï¼Œé€’å½’è®¡ç®—åœ¨å·¦å­æ ‘ä¸­çš„æ’åï¼›
- å¦‚æœå¤§äºï¼Œé€’å½’è®¡ç®—åœ¨å³å­æ ‘ä¸­çš„æ’åï¼ŒåŠ ä¸Šå·¦å­æ ‘çš„èŠ‚ç‚¹æ•°ï¼Œå†åŠ ä¸Š 1ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰ã€‚

```java
@Override
public int rank(Key key) {
    return rank(key, root);
}

private int rank(Key key, Node x) {
    if (x == null)
        return 0;
    int cmp = key.compareTo(x.key);
    if (cmp == 0)
        return size(x.left);
    else if (cmp < 0)
        return rank(key, x.left);
    else
        return 1 + size(x.left) + rank(key, x.right);
}
```

### 6. min()

```java
@Override
public Key min() {
    return min(root).key;
}

private Node min(Node x) {
    if (x == null)
        return null;
    if (x.left == null)
        return x;
    return min(x.left);
}
```

### 7. deleteMin()

ä»¤æŒ‡å‘æœ€å°èŠ‚ç‚¹çš„é“¾æ¥æŒ‡å‘æœ€å°èŠ‚ç‚¹çš„å³å­æ ‘ã€‚

<div align="center"> <img src="pics/dd15a984-e977-4644-b127-708cddb8ca99.png" width="500"/> </div><br>

```java
public void deleteMin() {
    root = deleteMin(root);
}

public Node deleteMin(Node x) {
    if (x.left == null)
        return x.right;
    x.left = deleteMin(x.left);
    recalculateSize(x);
    return x;
}
```

### 8. delete()

- å¦‚æœå¾…åˆ é™¤çš„èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªå­æ ‘ï¼Œ  é‚£ä¹ˆåªéœ€è¦è®©æŒ‡å‘å¾…åˆ é™¤èŠ‚ç‚¹çš„é“¾æ¥æŒ‡å‘å”¯ä¸€çš„å­æ ‘å³å¯ï¼›
- å¦åˆ™ï¼Œè®©å³å­æ ‘çš„æœ€å°èŠ‚ç‚¹æ›¿æ¢è¯¥èŠ‚ç‚¹ã€‚

<div align="center"> <img src="pics/fa568fac-ac58-48dd-a9bb-23b3065bf2dc.png" width="400"/> </div><br>

```java
public void delete(Key key) {
    root = delete(root, key);
}
private Node delete(Node x, Key key) {
    if (x == null)
        return null;
    int cmp = key.compareTo(x.key);
    if (cmp < 0)
        x.left = delete(x.left, key);
    else if (cmp > 0)
        x.right = delete(x.right, key);
    else {
        if (x.right == null)
            return x.left;
        if (x.left == null)
            return x.right;
        Node t = x;
        x = min(t.right);
        x.right = deleteMin(t.right);
        x.left = t.left;
    }
    recalculateSize(x);
    return x;
}
```

### 9. keys()

åˆ©ç”¨äºŒå‰æŸ¥æ‰¾æ ‘ä¸­åºéå†çš„ç»“æœä¸ºé€’å¢çš„ç‰¹ç‚¹ã€‚

```java
@Override
public List<Key> keys(Key l, Key h) {
    return keys(root, l, h);
}

private List<Key> keys(Node x, Key l, Key h) {
    List<Key> list = new ArrayList<>();
    if (x == null)
        return list;
    int cmpL = l.compareTo(x.key);
    int cmpH = h.compareTo(x.key);
    if (cmpL < 0)
        list.addAll(keys(x.left, l, h));
    if (cmpL <= 0 && cmpH >= 0)
        list.add(x.key);
    if (cmpH > 0)
        list.addAll(keys(x.right, l, h));
    return list;
}
```

### 10. åˆ†æ

äºŒå‰æŸ¥æ‰¾æ ‘æ‰€æœ‰æ“ä½œåœ¨æœ€åçš„æƒ…å†µä¸‹æ‰€éœ€è¦çš„æ—¶é—´éƒ½å’Œæ ‘çš„é«˜åº¦æˆæ­£æ¯”ã€‚

## 2-3 æŸ¥æ‰¾æ ‘

2-3 æŸ¥æ‰¾æ ‘å¼•å…¥äº† 2- èŠ‚ç‚¹å’Œ 3- èŠ‚ç‚¹ï¼Œç›®çš„æ˜¯ä¸ºäº†è®©æ ‘å¹³è¡¡ã€‚ä¸€é¢—å®Œç¾å¹³è¡¡çš„ 2-3 æŸ¥æ‰¾æ ‘çš„æ‰€æœ‰ç©ºé“¾æ¥åˆ°æ ¹èŠ‚ç‚¹çš„è·ç¦»åº”è¯¥æ˜¯ç›¸åŒçš„ã€‚

<div align="center"> <img src="pics/ff396233-1bb1-4e74-8bc2-d7c90146f5dd.png" width="250"/> </div><br>

### 1. æ’å…¥æ“ä½œ

æ’å…¥æ“ä½œå’Œ BST çš„æ’å…¥æ“ä½œæœ‰å¾ˆå¤§åŒºåˆ«ï¼ŒBST çš„æ’å…¥æ“ä½œæ˜¯å…ˆè¿›è¡Œä¸€æ¬¡æœªå‘½ä¸­çš„æŸ¥æ‰¾ï¼Œç„¶åå†å°†èŠ‚ç‚¹æ’å…¥åˆ°å¯¹åº”çš„ç©ºé“¾æ¥ä¸Šã€‚ä½†æ˜¯ 2-3 æŸ¥æ‰¾æ ‘å¦‚æœä¹Ÿè¿™ä¹ˆåšçš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šç ´åäº†å¹³è¡¡æ€§ã€‚å®ƒæ˜¯å°†æ–°èŠ‚ç‚¹æ’å…¥åˆ°å¶å­èŠ‚ç‚¹ä¸Šã€‚

æ ¹æ®å¶å­èŠ‚ç‚¹çš„ç±»å‹ä¸åŒï¼Œæœ‰ä¸åŒçš„å¤„ç†æ–¹å¼ï¼š

- å¦‚æœæ’å…¥åˆ° 2- èŠ‚ç‚¹ä¸Šï¼Œé‚£ä¹ˆç›´æ¥å°†æ–°èŠ‚ç‚¹å’ŒåŸæ¥çš„èŠ‚ç‚¹ç»„æˆ 3- èŠ‚ç‚¹å³å¯ã€‚

<div align="center"> <img src="pics/7f38a583-2f2e-4738-97af-510e6fb403a7.png" width="400"/> </div><br>

- å¦‚æœæ˜¯æ’å…¥åˆ° 3- èŠ‚ç‚¹ä¸Šï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªä¸´æ—¶ 4- èŠ‚ç‚¹æ—¶ï¼Œéœ€è¦å°† 4- èŠ‚ç‚¹åˆ†è£‚æˆ 3 ä¸ª 2- èŠ‚ç‚¹ï¼Œå¹¶å°†ä¸­é—´çš„ 2- èŠ‚ç‚¹ç§»åˆ°ä¸Šå±‚èŠ‚ç‚¹ä¸­ã€‚å¦‚æœä¸Šç§»æ“ä½œç»§ç»­äº§ç”Ÿä¸´æ—¶ 4- èŠ‚ç‚¹åˆ™ä¸€ç›´è¿›è¡Œåˆ†è£‚ä¸Šç§»ï¼Œç›´åˆ°ä¸å­˜åœ¨ä¸´æ—¶ 4- èŠ‚ç‚¹ã€‚

<div align="center"> <img src="pics/ef280699-da36-4b38-9735-9b048a3c7fe0.png" width="500"/> </div><br>

### 2. æ€§è´¨

2-3 æŸ¥æ‰¾æ ‘æ’å…¥æ“ä½œçš„å˜æ¢éƒ½æ˜¯å±€éƒ¨çš„ï¼Œé™¤äº†ç›¸å…³çš„èŠ‚ç‚¹å’Œé“¾æ¥ä¹‹å¤–ä¸å¿…ä¿®æ”¹æˆ–è€…æ£€æŸ¥æ ‘çš„å…¶å®ƒéƒ¨åˆ†ï¼Œè€Œè¿™äº›å±€éƒ¨å˜æ¢ä¸ä¼šå½±å“æ ‘çš„å…¨å±€æœ‰åºæ€§å’Œå¹³è¡¡æ€§ã€‚

2-3 æŸ¥æ‰¾æ ‘çš„æŸ¥æ‰¾å’Œæ’å…¥æ“ä½œå¤æ‚åº¦å’Œæ’å…¥é¡ºåºæ— å…³ï¼Œåœ¨æœ€åçš„æƒ…å†µä¸‹æŸ¥æ‰¾å’Œæ’å…¥æ“ä½œè®¿é—®çš„èŠ‚ç‚¹å¿…ç„¶ä¸è¶…è¿‡ logN ä¸ªï¼Œå«æœ‰ 10 äº¿ä¸ªèŠ‚ç‚¹çš„ 2-3 æŸ¥æ‰¾æ ‘æœ€å¤šåªéœ€è¦è®¿é—® 30 ä¸ªèŠ‚ç‚¹å°±èƒ½è¿›è¡Œä»»æ„çš„æŸ¥æ‰¾å’Œæ’å…¥æ“ä½œã€‚

## çº¢é»‘æ ‘

çº¢é»‘æ ‘æ˜¯ 2-3 æŸ¥æ‰¾æ ‘ï¼Œä½†å®ƒä¸éœ€è¦åˆ†åˆ«å®šä¹‰ 2- èŠ‚ç‚¹å’Œ 3- èŠ‚ç‚¹ï¼Œè€Œæ˜¯åœ¨æ™®é€šçš„äºŒå‰æŸ¥æ‰¾æ ‘ä¹‹ä¸Šï¼Œä¸ºèŠ‚ç‚¹æ·»åŠ é¢œè‰²ã€‚æŒ‡å‘ä¸€ä¸ªèŠ‚ç‚¹çš„é“¾æ¥é¢œè‰²å¦‚æœä¸ºçº¢è‰²ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹å’Œä¸Šå±‚èŠ‚ç‚¹è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ª 3- èŠ‚ç‚¹ï¼Œè€Œé»‘è‰²åˆ™æ˜¯æ™®é€šé“¾æ¥ã€‚

<div align="center"> <img src="pics/4f48e806-f90b-4c09-a55f-ac0cd641c047.png" width="250"/> </div><br>

çº¢é»‘æ ‘å…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š

- çº¢é“¾æ¥éƒ½ä¸ºå·¦é“¾æ¥ï¼›
- å®Œç¾é»‘è‰²å¹³è¡¡ï¼Œå³ä»»æ„ç©ºé“¾æ¥åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„ä¸Šçš„é»‘é“¾æ¥æ•°é‡ç›¸åŒã€‚

ç”»çº¢é»‘æ ‘æ—¶å¯ä»¥å°†çº¢é“¾æ¥ç”»å¹³ã€‚

<div align="center"> <img src="pics/3086c248-b552-499e-b101-9cffe5c2773e.png" width="300"/> </div><br>

```java
public class RedBlackBST<Key extends Comparable<Key>, Value> extends BST<Key, Value> {

    private static final boolean RED = true;
    private static final boolean BLACK = false;

    private boolean isRed(Node x) {
        if (x == null)
            return false;
        return x.color == RED;
    }
}
```

### 1. å·¦æ—‹è½¬

å› ä¸ºåˆæ³•çš„çº¢é“¾æ¥éƒ½ä¸ºå·¦é“¾æ¥ï¼Œå¦‚æœå‡ºç°å³é“¾æ¥ä¸ºçº¢é“¾æ¥ï¼Œé‚£ä¹ˆå°±éœ€è¦è¿›è¡Œå·¦æ—‹è½¬æ“ä½œã€‚

<div align="center"> <img src="pics/9110c1a0-8a54-4145-a814-2477d0128114.png" width="450"/> </div><br>

```java
public Node rotateLeft(Node h) {
    Node x = h.right;
    h.right = x.left;
    x.left = h;
    x.color = h.color;
    h.color = RED;
    x.N = h.N;
    recalculateSize(h);
    return x;
}
```

### 2. å³æ—‹è½¬

è¿›è¡Œå³æ—‹è½¬æ˜¯ä¸ºäº†è½¬æ¢ä¸¤ä¸ªè¿ç»­çš„å·¦çº¢é“¾æ¥ï¼Œè¿™ä¼šåœ¨ä¹‹åçš„æ’å…¥è¿‡ç¨‹ä¸­æ¢è®¨ã€‚

<div align="center"> <img src="pics/e2f0d889-2330-424c-8193-198edebecff7.png" width="450"/> </div><br>

```java
public Node rotateRight(Node h) {
    Node x = h.left;
    h.left = x.right;
    x.color = h.color;
    h.color = RED;
    x.N = h.N;
    recalculateSize(h);
    return x;
}
```

### 3. é¢œè‰²è½¬æ¢

ä¸€ä¸ª 4- èŠ‚ç‚¹åœ¨çº¢é»‘æ ‘ä¸­è¡¨ç°ä¸ºä¸€ä¸ªèŠ‚ç‚¹çš„å·¦å³å­èŠ‚ç‚¹éƒ½æ˜¯çº¢è‰²çš„ã€‚åˆ†è£‚ 4- èŠ‚ç‚¹é™¤äº†éœ€è¦å°†å­èŠ‚ç‚¹çš„é¢œè‰²ç”±çº¢å˜é»‘ä¹‹å¤–ï¼ŒåŒæ—¶éœ€è¦å°†çˆ¶èŠ‚ç‚¹çš„é¢œè‰²ç”±é»‘å˜çº¢ï¼Œä» 2-3 æ ‘çš„è§’åº¦çœ‹å°±æ˜¯å°†ä¸­é—´èŠ‚ç‚¹ç§»åˆ°ä¸Šå±‚èŠ‚ç‚¹ã€‚

<div align="center"> <img src="pics/af4639f9-af54-4400-aaf5-4e261d96ace7.png" width="300"/> </div><br>

```java
void flipColors(Node h) {
    h.color = RED;
    h.left.color = BLACK;
    h.right.color = BLACK;
}
```

### 4. æ’å…¥

å…ˆå°†ä¸€ä¸ªèŠ‚ç‚¹æŒ‰äºŒå‰æŸ¥æ‰¾æ ‘çš„æ–¹æ³•æ’å…¥åˆ°æ­£ç¡®ä½ç½®ï¼Œç„¶åå†è¿›è¡Œå¦‚ä¸‹é¢œè‰²æ“ä½œï¼š

- å¦‚æœå³å­èŠ‚ç‚¹æ˜¯çº¢è‰²çš„è€Œå·¦å­èŠ‚ç‚¹æ˜¯é»‘è‰²çš„ï¼Œè¿›è¡Œå·¦æ—‹è½¬ï¼›
- å¦‚æœå·¦å­èŠ‚ç‚¹æ˜¯çº¢è‰²çš„ï¼Œè€Œä¸”å·¦å­èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ä¹Ÿæ˜¯çº¢è‰²çš„ï¼Œè¿›è¡Œå³æ—‹è½¬ï¼›
- å¦‚æœå·¦å³å­èŠ‚ç‚¹å‡ä¸ºçº¢è‰²çš„ï¼Œè¿›è¡Œé¢œè‰²è½¬æ¢ã€‚

<div align="center"> <img src="pics/08427d38-8df1-49a1-8990-e0ce5ee36ca2.png" width="400"/> </div><br>

```java
@Override
public void put(Key key, Value value) {
    root = put(root, key, value);
    root.color = BLACK;
}

private Node put(Node x, Key key, Value value) {
    if (x == null) {
        Node node = new Node(key, value, 1);
        node.color = RED;
        return node;
    }
    int cmp = key.compareTo(x.key);
    if (cmp == 0)
        x.val = value;
    else if (cmp < 0)
        x.left = put(x.left, key, value);
    else
        x.right = put(x.right, key, value);

    if (isRed(x.right) && !isRed(x.left))
        x = rotateLeft(x);
    if (isRed(x.left) && isRed(x.left.left))
        x = rotateRight(x);
    if (isRed(x.left) && isRed(x.right))
        flipColors(x);

    recalculateSize(x);
    return x;
}
```

å¯ä»¥çœ‹åˆ°è¯¥æ’å…¥æ“ä½œå’ŒäºŒå‰æŸ¥æ‰¾æ ‘çš„æ’å…¥æ“ä½œç±»ä¼¼ï¼Œåªæ˜¯åœ¨æœ€ååŠ å…¥äº†æ—‹è½¬å’Œé¢œè‰²å˜æ¢æ“ä½œå³å¯ã€‚

æ ¹èŠ‚ç‚¹ä¸€å®šä¸ºé»‘è‰²ï¼Œå› ä¸ºæ ¹èŠ‚ç‚¹æ²¡æœ‰ä¸Šå±‚èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ²¡æœ‰ä¸Šå±‚èŠ‚ç‚¹çš„å·¦é“¾æ¥æŒ‡å‘æ ¹èŠ‚ç‚¹ã€‚flipColors() æœ‰å¯èƒ½ä¼šä½¿å¾—æ ¹èŠ‚ç‚¹çš„é¢œè‰²å˜ä¸ºçº¢è‰²ï¼Œæ¯å½“æ ¹èŠ‚ç‚¹ç”±çº¢è‰²å˜æˆé»‘è‰²æ—¶æ ‘çš„é»‘é“¾æ¥é«˜åº¦åŠ  1.

### 5. åˆ†æ

ä¸€é¢—å¤§å°ä¸º N çš„çº¢é»‘æ ‘çš„é«˜åº¦ä¸ä¼šè¶…è¿‡ 2logNã€‚æœ€åçš„æƒ…å†µä¸‹æ˜¯å®ƒæ‰€å¯¹åº”çš„ 2-3 æ ‘ï¼Œæ„æˆæœ€å·¦è¾¹çš„è·¯å¾„èŠ‚ç‚¹å…¨éƒ¨éƒ½æ˜¯ 3- èŠ‚ç‚¹è€Œå…¶ä½™éƒ½æ˜¯ 2- èŠ‚ç‚¹ã€‚

çº¢é»‘æ ‘å¤§å¤šæ•°çš„æ“ä½œæ‰€éœ€è¦çš„æ—¶é—´éƒ½æ˜¯å¯¹æ•°çº§åˆ«çš„ã€‚

## æ•£åˆ—è¡¨

æ•£åˆ—è¡¨ç±»ä¼¼äºæ•°ç»„ï¼Œå¯ä»¥æŠŠæ•£åˆ—è¡¨çš„æ•£åˆ—å€¼çœ‹æˆæ•°ç»„çš„ç´¢å¼•å€¼ã€‚è®¿é—®æ•£åˆ—è¡¨å’Œè®¿é—®æ•°ç»„å…ƒç´ ä¸€æ ·å¿«é€Ÿï¼Œå®ƒå¯ä»¥åœ¨å¸¸æ•°æ—¶é—´å†…å®ç°æŸ¥æ‰¾å’Œæ’å…¥æ“ä½œã€‚

ç”±äºæ— æ³•é€šè¿‡æ•£åˆ—å€¼çŸ¥é“é”®çš„å¤§å°å…³ç³»ï¼Œå› æ­¤æ•£åˆ—è¡¨æ— æ³•å®ç°æœ‰åºæ€§æ“ä½œã€‚

### 1. æ•£åˆ—å‡½æ•°

å¯¹äºä¸€ä¸ªå¤§å°ä¸º M çš„æ•£åˆ—è¡¨ï¼Œæ•£åˆ—å‡½æ•°èƒ½å¤ŸæŠŠä»»æ„é”®è½¬æ¢ä¸º [0, M-1] å†…çš„æ­£æ•´æ•°ï¼Œè¯¥æ­£æ•´æ•°å³ä¸º hash å€¼ã€‚

æ•£åˆ—è¡¨å­˜åœ¨å†²çªï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªä¸åŒçš„é”®å¯èƒ½æœ‰ç›¸åŒçš„ hash å€¼ã€‚

æ•£åˆ—å‡½æ•°åº”è¯¥æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼š

- ä¸€è‡´æ€§ï¼šç›¸ç­‰çš„é”®åº”å½“æœ‰ç›¸ç­‰çš„ hash å€¼ï¼Œä¸¤ä¸ªé”®ç›¸ç­‰è¡¨ç¤ºè°ƒç”¨ equals() è¿”å›çš„å€¼ç›¸ç­‰ã€‚
- é«˜æ•ˆæ€§ï¼šè®¡ç®—åº”å½“ç®€ä¾¿ï¼Œæœ‰å¿…è¦çš„è¯å¯ä»¥æŠŠ hash å€¼ç¼“å­˜èµ·æ¥ï¼Œåœ¨è°ƒç”¨ hash å‡½æ•°æ—¶ç›´æ¥è¿”å›ã€‚
- å‡åŒ€æ€§ï¼šæ‰€æœ‰é”®çš„ hash å€¼åº”å½“å‡åŒ€åœ°åˆ†å¸ƒåˆ° [0, M-1] ä¹‹é—´ï¼Œå¦‚æœä¸èƒ½æ»¡è¶³è¿™ä¸ªæ¡ä»¶ï¼Œæœ‰å¯èƒ½äº§ç”Ÿå¾ˆå¤šå†²çªï¼Œä»è€Œå¯¼è‡´æ•£åˆ—è¡¨çš„æ€§èƒ½ä¸‹é™ã€‚

é™¤ç•™ä½™æ•°æ³•å¯ä»¥å°†æ•´æ•°æ•£åˆ—åˆ° [0, M-1] ä¹‹é—´ï¼Œä¾‹å¦‚ä¸€ä¸ªæ­£æ•´æ•° kï¼Œè®¡ç®— k%M æ—¢å¯å¾—åˆ°ä¸€ä¸ª [0, M-1] ä¹‹é—´çš„ hash å€¼ã€‚æ³¨æ„ M å¿…é¡»æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œå¦åˆ™æ— æ³•åˆ©ç”¨é”®åŒ…å«çš„æ‰€æœ‰ä¿¡æ¯ã€‚ä¾‹å¦‚ M ä¸º 10<sup>k</sup>ï¼Œé‚£ä¹ˆåªèƒ½åˆ©ç”¨é”®çš„å k ä½ã€‚

å¯¹äºå…¶å®ƒæ•°ï¼Œå¯ä»¥å°†å…¶è½¬æ¢æˆæ•´æ•°çš„å½¢å¼ï¼Œç„¶ååˆ©ç”¨é™¤ç•™ä½™æ•°æ³•ã€‚ä¾‹å¦‚å¯¹äºæµ®ç‚¹æ•°ï¼Œå¯ä»¥å°†å…¶çš„äºŒè¿›åˆ¶å½¢å¼è½¬æ¢æˆæ•´æ•°ã€‚

å¯¹äºå¤šéƒ¨åˆ†ç»„åˆçš„ç±»å‹ï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½éœ€è¦è®¡ç®— hash å€¼ï¼Œè¿™äº› hash å€¼éƒ½å…·æœ‰åŒç­‰é‡è¦çš„åœ°ä½ã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œå¯ä»¥å°†è¯¥ç±»å‹çœ‹æˆ R è¿›åˆ¶çš„æ•´æ•°ï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½å…·æœ‰ä¸åŒçš„æƒå€¼ã€‚

ä¾‹å¦‚ï¼Œå­—ç¬¦ä¸²çš„æ•£åˆ—å‡½æ•°å®ç°å¦‚ä¸‹ï¼š

```java
int hash = 0;
for (int i = 0; i < s.length(); i++)
    hash = (R * hash + s.charAt(i)) % M;
```

å†æ¯”å¦‚ï¼Œæ‹¥æœ‰å¤šä¸ªæˆå‘˜çš„è‡ªå®šä¹‰ç±»çš„å“ˆå¸Œå‡½æ•°å¦‚ä¸‹ï¼š

```java
int hash = (((day * R + month) % M) * R + year) % M;
```

R é€šå¸¸å– 31ã€‚

Java ä¸­çš„ hashCode() å®ç°äº†å“ˆå¸Œå‡½æ•°ï¼Œä½†æ˜¯é»˜è®¤ä½¿ç”¨å¯¹è±¡çš„å†…å­˜åœ°å€å€¼ã€‚åœ¨ä½¿ç”¨ hashCode() æ—¶ï¼Œåº”å½“ç»“åˆé™¤ç•™ä½™æ•°æ³•æ¥ä½¿ç”¨ã€‚å› ä¸ºå†…å­˜åœ°å€æ˜¯ 32 ä½æ•´æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦ 31 ä½çš„éè´Ÿæ•´æ•°ï¼Œå› æ­¤åº”å½“å±è”½ç¬¦å·ä½ä¹‹åå†ä½¿ç”¨é™¤ç•™ä½™æ•°æ³•ã€‚

```java
int hash = (x.hashCode() & 0x7fffffff) % M;
```

ä½¿ç”¨ Java çš„ HashMap ç­‰è‡ªå¸¦çš„å“ˆå¸Œè¡¨å®ç°æ—¶ï¼Œåªéœ€è¦å»å®ç° Key ç±»å‹çš„ hashCode() å‡½æ•°å³å¯ã€‚Java è§„å®š hashCode() èƒ½å¤Ÿå°†é”®å‡åŒ€åˆ†å¸ƒäºæ‰€æœ‰çš„ 32 ä½æ•´æ•°ï¼ŒJava ä¸­çš„ Stringã€Integer ç­‰å¯¹è±¡çš„ hashCode() éƒ½èƒ½å®ç°è¿™ä¸€ç‚¹ã€‚ä»¥ä¸‹å±•ç¤ºäº†è‡ªå®šä¹‰ç±»å‹å¦‚ä½•å®ç° hashCode()ï¼š

```java
public class Transaction {

    private final String who;
    private final Date when;
    private final double amount;

    public Transaction(String who, Date when, double amount) {
        this.who = who;
        this.when = when;
        this.amount = amount;
    }

    public int hashCode() {
        int hash = 17;
        int R = 31;
        hash = R * hash + who.hashCode();
        hash = R * hash + when.hashCode();
        hash = R * hash + ((Double) amount).hashCode();
        return hash;
    }
}
```

### 2. æ‹‰é“¾æ³•

æ‹‰é“¾æ³•ä½¿ç”¨é“¾è¡¨æ¥å­˜å‚¨ hash å€¼ç›¸åŒçš„é”®ï¼Œä»è€Œè§£å†³å†²çªã€‚

æŸ¥æ‰¾éœ€è¦åˆ†ä¸¤æ­¥ï¼Œé¦–å…ˆæŸ¥æ‰¾ Key æ‰€åœ¨çš„é“¾è¡¨ï¼Œç„¶ååœ¨é“¾è¡¨ä¸­é¡ºåºæŸ¥æ‰¾ã€‚

å¯¹äº N ä¸ªé”®ï¼ŒM æ¡é“¾è¡¨ (N>M)ï¼Œå¦‚æœå“ˆå¸Œå‡½æ•°èƒ½å¤Ÿæ»¡è¶³å‡åŒ€æ€§çš„æ¡ä»¶ï¼Œæ¯æ¡é“¾è¡¨çš„å¤§å°è¶‹å‘äº N/Mï¼Œå› æ­¤æœªå‘½ä¸­çš„æŸ¥æ‰¾å’Œæ’å…¥æ“ä½œæ‰€éœ€è¦çš„æ¯”è¾ƒæ¬¡æ•°ä¸º \~N/Mã€‚

<div align="center"> <img src="pics/b4252c85-6fb0-4995-9a68-a1a5925fbdb1.png" width="300"/> </div><br>

### 3. çº¿æ€§æ¢æµ‹æ³•

çº¿æ€§æ¢æµ‹æ³•ä½¿ç”¨ç©ºä½æ¥è§£å†³å†²çªï¼Œå½“å†²çªå‘ç”Ÿæ—¶ï¼Œå‘å‰æ¢æµ‹ä¸€ä¸ªç©ºä½æ¥å­˜å‚¨å†²çªçš„é”®ã€‚

ä½¿ç”¨çº¿æ€§æ¢æµ‹æ³•ï¼Œæ•°ç»„çš„å¤§å° M åº”å½“å¤§äºé”®çš„ä¸ªæ•° Nï¼ˆM>N)ã€‚

<div align="center"> <img src="pics/dbb8516d-37ba-4e2c-b26b-eefd7de21b45.png" width="400"/> </div><br>

```java
public class LinearProbingHashST<Key, Value> implements UnorderedST<Key, Value> {

    private int N = 0;
    private int M = 16;
    private Key[] keys;
    private Value[] values;

    public LinearProbingHashST() {
        init();
    }

    public LinearProbingHashST(int M) {
        this.M = M;
        init();
    }

    private void init() {
        keys = (Key[]) new Object[M];
        values = (Value[]) new Object[M];
    }

    private int hash(Key key) {
        return (key.hashCode() & 0x7fffffff) % M;
    }
}
```

#### 3.1 æŸ¥æ‰¾

```java
public Value get(Key key) {
    for (int i = hash(key); keys[i] != null; i = (i + 1) % M)
        if (keys[i].equals(key))
            return values[i];

    return null;
}
```

#### 3.2 æ’å…¥

```java
public void put(Key key, Value value) {
    resize();
    putInternal(key, value);
}

private void putInternal(Key key, Value value) {
    int i;
    for (i = hash(key); keys[i] != null; i = (i + 1) % M)
        if (keys[i].equals(key)) {
            values[i] = value;
            return;
        }

    keys[i] = key;
    values[i] = value;
    N++;
}
```

#### 3.3 åˆ é™¤

åˆ é™¤æ“ä½œåº”å½“å°†å³ä¾§æ‰€æœ‰ç›¸é‚»çš„é”®å€¼å¯¹é‡æ–°æ’å…¥æ•£åˆ—è¡¨ä¸­ã€‚

```java
public void delete(Key key) {
    int i = hash(key);
    while (keys[i] != null && !key.equals(keys[i]))
        i = (i + 1) % M;

    // ä¸å­˜åœ¨ï¼Œç›´æ¥è¿”å›
    if (keys[i] == null)
        return;

    keys[i] = null;
    values[i] = null;

    // å°†ä¹‹åç›¸è¿çš„é”®å€¼å¯¹é‡æ–°æ’å…¥
    i = (i + 1) % M;
    while (keys[i] != null) {
        Key keyToRedo = keys[i];
        Value valToRedo = values[i];
        keys[i] = null;
        values[i] = null;
        N--;
        putInternal(keyToRedo, valToRedo);
        i = (i + 1) % M;
    }
    N--;
    resize();
}
```

#### 3.5 è°ƒæ•´æ•°ç»„å¤§å°

çº¿æ€§æ¢æµ‹æ³•çš„æˆæœ¬å–å†³äºè¿ç»­æ¡ç›®çš„é•¿åº¦ï¼Œè¿ç»­æ¡ç›®ä¹Ÿå«èšç°‡ã€‚å½“èšç°‡å¾ˆé•¿æ—¶ï¼Œåœ¨æŸ¥æ‰¾å’Œæ’å…¥æ—¶ä¹Ÿéœ€è¦è¿›è¡Œå¾ˆå¤šæ¬¡æ¢æµ‹ã€‚ä¾‹å¦‚ä¸‹å›¾ä¸­ 2\~5 ä½ç½®å°±æ˜¯ä¸€ä¸ªèšç°‡ã€‚

<div align="center"> <img src="pics/386cd64f-7a9d-40e6-8c55-22b90ee2d258.png" width="400"/> </div><br>

Î± = N/Mï¼ŒæŠŠ Î± ç§°ä¸ºä½¿ç”¨ç‡ã€‚ç†è®ºè¯æ˜ï¼Œå½“ Î± å°äº 1/2 æ—¶æ¢æµ‹çš„é¢„è®¡æ¬¡æ•°åªåœ¨ 1.5 åˆ° 2.5 ä¹‹é—´ã€‚ä¸ºäº†ä¿è¯æ•£åˆ—è¡¨çš„æ€§èƒ½ï¼Œåº”å½“è°ƒæ•´æ•°ç»„çš„å¤§å°ï¼Œä½¿å¾— Î± åœ¨ [1/4, 1/2] ä¹‹é—´ã€‚

```java
private void resize() {
    if (N >= M / 2)
        resize(2 * M);
    else if (N <= M / 8)
        resize(M / 2);
}

private void resize(int cap) {
    LinearProbingHashST<Key, Value> t = new LinearProbingHashST<Key, Value>(cap);
    for (int i = 0; i < M; i++)
        if (keys[i] != null)
            t.putInternal(keys[i], values[i]);

    keys = t.keys;
    values = t.values;
    M = t.M;
}
```

## å°ç»“

### 1. ç¬¦å·è¡¨ç®—æ³•æ¯”è¾ƒ

| ç®—æ³• | æ’å…¥ | æŸ¥æ‰¾ | æ˜¯å¦æœ‰åº |
| :---: | :---: | :---: | :---: |
| é“¾è¡¨å®ç°çš„æ— åºç¬¦å·è¡¨ | N | N | yes |
| äºŒåˆ†æŸ¥æ‰¾å®ç°çš„æœ‰åºç¬¦å·è¡¨ | N | logN | yes |
| äºŒå‰æŸ¥æ‰¾æ ‘ | logN | logN | yes |
| 2-3 æŸ¥æ‰¾æ ‘ | logN | logN | yes |
| æ‹‰é“¾æ³•å®ç°çš„æ•£åˆ—è¡¨ | N/M | N/M | no |
| çº¿æ€§æ¢æµ‹æ³•å®ç°çš„æ•£åˆ—è¡¨ | 1 | 1 | no |

åº”å½“ä¼˜å…ˆè€ƒè™‘æ•£åˆ—è¡¨ï¼Œå½“éœ€è¦æœ‰åºæ€§æ“ä½œæ—¶ä½¿ç”¨çº¢é»‘æ ‘ã€‚

### 2. Java çš„ç¬¦å·è¡¨å®ç°

- java.util.TreeMapï¼šçº¢é»‘æ ‘
- java.util.HashMapï¼šæ‹‰é“¾æ³•çš„æ•£åˆ—è¡¨

### 3. ç¨€ç–å‘é‡ä¹˜æ³•

å½“å‘é‡ä¸ºç¨€ç–å‘é‡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç¬¦å·è¡¨æ¥å­˜å‚¨å‘é‡ä¸­çš„é 0 ç´¢å¼•å’Œå€¼ï¼Œä½¿å¾—ä¹˜æ³•è¿ç®—åªéœ€è¦å¯¹é‚£äº›é 0 å…ƒç´ è¿›è¡Œå³å¯ã€‚

```java
public class SparseVector {
    private HashMap<Integer, Double> hashMap;

    public SparseVector(double[] vector) {
        hashMap = new HashMap<>();
        for (int i = 0; i < vector.length; i++)
            if (vector[i] != 0)
                hashMap.put(i, vector[i]);
    }

    public double get(int i) {
        return hashMap.getOrDefault(i, 0.0);
    }

    public double dot(SparseVector other) {
        double sum = 0;
        for (int i : hashMap.keySet())
            sum += this.get(i) * other.get(i);
        return sum;
    }
}
```

# ä¸ƒã€å…¶å®ƒ

## æ±‰è¯ºå¡”

<div align="center"> <img src="pics/54f1e052-0596-4b5e-833c-e80d75bf3f9b.png" width="300"/> </div><br>

æœ‰ä¸‰ä¸ªæŸ±å­ï¼Œåˆ†åˆ«ä¸º fromã€bufferã€toã€‚éœ€è¦å°† from ä¸Šçš„åœ†ç›˜å…¨éƒ¨ç§»åŠ¨åˆ° to ä¸Šï¼Œå¹¶ä¸”è¦ä¿è¯å°åœ†ç›˜å§‹ç»ˆåœ¨å¤§åœ†ç›˜ä¸Šã€‚

è¿™æ˜¯ä¸€ä¸ªç»å…¸çš„é€’å½’é—®é¢˜ï¼Œåˆ†ä¸ºä¸‰æ­¥æ±‚è§£ï¼š

â‘  å°† n-1 ä¸ªåœ†ç›˜ä» from -> buffer

<div align="center"> <img src="pics/8587132a-021d-4f1f-a8ec-5a9daa7157a7.png" width="300"/> </div><br>

â‘¡ å°† 1 ä¸ªåœ†ç›˜ä» from -> to

<div align="center"> <img src="pics/2861e923-4862-4526-881c-15529279d49c.png" width="300"/> </div><br>

â‘¢ å°† n-1 ä¸ªåœ†ç›˜ä» buffer -> to

<div align="center"> <img src="pics/1c4e8185-8153-46b6-bd5a-288b15feeae6.png" width="300"/> </div><br>

å¦‚æœåªæœ‰ä¸€ä¸ªåœ†ç›˜ï¼Œé‚£ä¹ˆåªéœ€è¦è¿›è¡Œä¸€æ¬¡ç§»åŠ¨æ“ä½œã€‚

ä»ä¸Šé¢çš„è®¨è®ºå¯ä»¥çŸ¥é“ï¼Œa<sub>n</sub> = 2 * a<sub>n-1</sub> + 1ï¼Œæ˜¾ç„¶ a<sub>n</sub> = 2<sup>n</sup> - 1ï¼Œn ä¸ªåœ†ç›˜éœ€è¦ç§»åŠ¨ 2<sup>n</sup> - 1 æ¬¡ã€‚

```java
public class Hanoi {
    public static void move(int n, String from, String buffer, String to) {
        if (n == 1) {
            System.out.println("from " + from + " to " + to);
            return;
        }
        move(n - 1, from, to, buffer);
        move(1, from, buffer, to);
        move(n - 1, buffer, from, to);
    }

    public static void main(String[] args) {
        Hanoi.move(3, "H1", "H2", "H3");
    }
}
```

```html
from H1 to H3
from H1 to H2
from H3 to H2
from H1 to H3
from H2 to H1
from H2 to H3
from H1 to H3
```

## å“ˆå¤«æ›¼ç¼–ç 

æ ¹æ®æ•°æ®å‡ºç°çš„é¢‘ç‡å¯¹æ•°æ®è¿›è¡Œç¼–ç ï¼Œä»è€Œå‹ç¼©åŸå§‹æ•°æ®ã€‚

ä¾‹å¦‚å¯¹äºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­å„ç§å­—ç¬¦å‡ºç°çš„æ¬¡æ•°å¦‚ä¸‹ï¼š

- a : 10
- b : 20
- c : 40
- d : 80

å¯ä»¥å°†æ¯ç§å­—ç¬¦è½¬æ¢æˆäºŒè¿›åˆ¶ç¼–ç ï¼Œä¾‹å¦‚å°† a è½¬æ¢ä¸º 00ï¼Œb è½¬æ¢ä¸º 01ï¼Œc è½¬æ¢ä¸º 10ï¼Œd è½¬æ¢ä¸º 11ã€‚è¿™æ˜¯æœ€ç®€å•çš„ä¸€ç§ç¼–ç æ–¹å¼ï¼Œæ²¡æœ‰è€ƒè™‘å„ä¸ªå­—ç¬¦çš„æƒå€¼ï¼ˆå‡ºç°é¢‘ç‡ï¼‰ã€‚è€Œå“ˆå¤«æ›¼ç¼–ç é‡‡ç”¨äº†è´ªå¿ƒç­–ç•¥ï¼Œä½¿å‡ºç°é¢‘ç‡æœ€é«˜çš„å­—ç¬¦çš„ç¼–ç æœ€çŸ­ï¼Œä»è€Œä¿è¯æ•´ä½“çš„ç¼–ç é•¿åº¦æœ€çŸ­ã€‚

é¦–å…ˆç”Ÿæˆä¸€é¢—å“ˆå¤«æ›¼æ ‘ï¼Œæ¯æ¬¡ç”Ÿæˆè¿‡ç¨‹ä¸­é€‰å–é¢‘ç‡æœ€å°‘çš„ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œç”Ÿæˆä¸€ä¸ªæ–°èŠ‚ç‚¹ä½œä¸ºå®ƒä»¬çš„çˆ¶èŠ‚ç‚¹ï¼Œå¹¶ä¸”æ–°èŠ‚ç‚¹çš„é¢‘ç‡ä¸ºä¸¤ä¸ªèŠ‚ç‚¹çš„å’Œã€‚é€‰å–é¢‘ç‡æœ€å°‘çš„åŸå› æ˜¯ï¼Œç”Ÿæˆè¿‡ç¨‹ä½¿å¾—å…ˆé€‰å–çš„èŠ‚ç‚¹ä½äºæ ‘çš„æ›´ä½å±‚ï¼Œé‚£ä¹ˆéœ€è¦çš„ç¼–ç é•¿åº¦æ›´é•¿ï¼Œé¢‘ç‡æ›´å°‘å¯ä»¥ä½¿å¾—æ€»ç¼–ç é•¿åº¦æ›´å°‘ã€‚

ç”Ÿæˆç¼–ç æ—¶ï¼Œä»æ ¹èŠ‚ç‚¹å‡ºå‘ï¼Œå‘å·¦éå†åˆ™æ·»åŠ äºŒè¿›åˆ¶ä½ 0ï¼Œå‘å³åˆ™æ·»åŠ äºŒè¿›åˆ¶ä½ 1ï¼Œç›´åˆ°éå†åˆ°å¶å­èŠ‚ç‚¹ï¼Œå¶å­èŠ‚ç‚¹ä»£è¡¨çš„å­—ç¬¦çš„ç¼–ç å°±æ˜¯è¿™ä¸ªè·¯å¾„ç¼–ç ã€‚

<div align="center"> <img src="pics/3ff4f00a-2321-48fd-95f4-ce6001332151.png" width="400"/> </div><br>

```java
public class Huffman {

    private class Node implements Comparable<Node> {
        char ch;
        int freq;
        boolean isLeaf;
        Node left, right;

        public Node(char ch, int freq) {
            this.ch = ch;
            this.freq = freq;
            isLeaf = true;
        }

        public Node(Node left, Node right, int freq) {
            this.left = left;
            this.right = right;
            this.freq = freq;
            isLeaf = false;
        }

        @Override
        public int compareTo(Node o) {
            return this.freq - o.freq;
        }
    }

    public Map<Character, String> encode(Map<Character, Integer> frequencyForChar) {
        PriorityQueue<Node> priorityQueue = new PriorityQueue<>();
        for (Character c : frequencyForChar.keySet()) {
            priorityQueue.add(new Node(c, frequencyForChar.get(c)));
        }
        while (priorityQueue.size() != 1) {
            Node node1 = priorityQueue.poll();
            Node node2 = priorityQueue.poll();
            priorityQueue.add(new Node(node1, node2, node1.freq + node2.freq));
        }
        return encode(priorityQueue.poll());
    }

    private Map<Character, String> encode(Node root) {
        Map<Character, String> encodingForChar = new HashMap<>();
        encode(root, "", encodingForChar);
        return encodingForChar;
    }

    private void encode(Node node, String encoding, Map<Character, String> encodingForChar) {
        if (node.isLeaf) {
            encodingForChar.put(node.ch, encoding);
            return;
        }
        encode(node.left, encoding + '0', encodingForChar);
        encode(node.right, encoding + '1', encodingForChar);
    }
}
```

# å‚è€ƒèµ„æ–™

- Sedgewick, Robert, and Kevin Wayne. _Algorithms_. Addison-Wesley Professional, 2011.

